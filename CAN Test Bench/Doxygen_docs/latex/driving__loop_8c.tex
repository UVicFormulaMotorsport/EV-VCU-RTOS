\hypertarget{driving__loop_8c}{}\doxysection{Core/\+Src/driving\+\_\+loop.c File Reference}
\label{driving__loop_8c}\index{Core/Src/driving\_loop.c@{Core/Src/driving\_loop.c}}


File containing the meat and potatoes driving loop thread, and all supporting functions.  


{\ttfamily \#include \char`\"{}main.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}uvfr\+\_\+utils.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}can.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}motor\+\_\+controller.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Free\+R\+T\+O\+S.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cmsis\+\_\+os.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include \char`\"{}driving\+\_\+loop.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{driving__loop_8c_a3fa2d9e8a3ff5bc7ac576fda26265b44}{A\+C\+C\+E\+L\+E\+R\+A\+T\+I\+ON}}~0
\item 
\#define \mbox{\hyperlink{driving__loop_8c_a7c627c95d1731c3c24a41b8aa86a5fd5}{A\+U\+T\+O\+C\+R\+O\+SS}}~1
\item 
\#define \mbox{\hyperlink{driving__loop_8c_a64a87e1f80735e94aac871db572dda97}{E\+N\+D\+U\+R\+A\+N\+CE}}~2
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
float \mbox{\hyperlink{driving__loop_8c_ad5227d6e3a1f9c241f31f07abe9f1695}{calculate\+Throttle\+Percentage}} (uint16\+\_\+t apps1, uint16\+\_\+t apps2)
\item 
\mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} \mbox{\hyperlink{driving__loop_8c_ac9c776513f26edd5cf75280eea26275b}{perform\+Safety\+Checks}} (\mbox{\hyperlink{structdriving__loop__args}{driving\+\_\+loop\+\_\+args}} $\ast$dl\+\_\+params, uint16\+\_\+t apps1\+\_\+value, uint16\+\_\+t apps2\+\_\+value, uint16\+\_\+t bps1\+\_\+value, uint16\+\_\+t bps2\+\_\+value, enum \mbox{\hyperlink{driving__loop_8h_adef4571b048b5b1f2b712713741296c7}{D\+L\+\_\+internal\+\_\+state}} $\ast$dl\+\_\+status)
\begin{DoxyCompactList}\small\item\em Converts A\+P\+PS sensor readings into a throttle percentage. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{uvfr__utils_8h_a71c52c44be11d0980910401cb9b5fb9e}{uv\+\_\+status\+\_\+t}} \mbox{\hyperlink{driving__loop_8c_af580185fb5bb1cfba30ee1709d90628c}{init\+Driving\+Loop}} (void $\ast$argument)
\item 
static float \mbox{\hyperlink{driving__loop_8c_a14bdb2b38c226aa850a0c25207afd1fa}{map\+Throttle\+To\+Torque}} (float throttle\+\_\+percent)
\item 
float \mbox{\hyperlink{driving__loop_8c_abdfd52d179ac8c6707ea8e0ddb98b7cd}{get\+K\+Value}} (int race\+Mode)
\item 
static float \mbox{\hyperlink{driving__loop_8c_a42c4321a28da09906e185c9c5971fce9}{apply\+Torque\+Filter}} (float T\+\_\+req, float T\+\_\+prev, \mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} is\+\_\+accelearting)
\begin{DoxyCompactList}\small\item\em Applies filtering to smooth torque transitions. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{driving__loop_8c_a1eee9dfaef3aaaf010bd8bb12fa20fc3}{send\+Torque\+To\+Motor\+Controller}} (float T\+\_\+filtered)
\begin{DoxyCompactList}\small\item\em Sends the filtered torque value to the motor controller. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{driving__loop_8c_a80cc48f06202edc29bcad26a956bcc98}{Start\+Driving\+Loop}} (void $\ast$argument)
\begin{DoxyCompactList}\small\item\em Function implementing the led\+Task thread. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
uint16\+\_\+t \mbox{\hyperlink{driving__loop_8c_a549b3590f54dfc129d2eebf2604c16e8}{adc1\+\_\+\+A\+P\+P\+S1}}
\item 
uint16\+\_\+t \mbox{\hyperlink{driving__loop_8c_a8567d6e2f5ad8bd53f71ecc2b2b0ae30}{adc1\+\_\+\+A\+P\+P\+S2}}
\item 
uint16\+\_\+t \mbox{\hyperlink{driving__loop_8c_ad36d3aa4037203058df6816d56f4c186}{adc1\+\_\+\+B\+P\+S1}}
\item 
uint16\+\_\+t \mbox{\hyperlink{driving__loop_8c_a277f7921a7a1e0fb8a6f953943dc06dc}{adc1\+\_\+\+B\+P\+S2}}
\item 
\mbox{\hyperlink{structdriving__loop__args}{driving\+\_\+loop\+\_\+args}} \mbox{\hyperlink{driving__loop_8c_ab8788a0f246816c11002008cb43d1886}{default\+\_\+dl\+\_\+settings}}
\item 
\mbox{\hyperlink{structdriving__loop__args}{driving\+\_\+loop\+\_\+args}} $\ast$ \mbox{\hyperlink{driving__loop_8c_a401dd8422f51d8d344e5ac9559ef8908}{driving\+\_\+args}} = N\+U\+LL
\item 
\mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} \mbox{\hyperlink{driving__loop_8c_a15e200c9bf4f5d49b02215e273d2d841}{is\+\_\+accelerating}} = \mbox{\hyperlink{group__utility__macros_ga65e9886d74aaee76545e83dd09011727}{false}}
\item 
float \mbox{\hyperlink{driving__loop_8c_afb126e9ab9acbc2c02585ce5728a538a}{T\+\_\+\+P\+R\+EV}} = 0
\item 
float \mbox{\hyperlink{driving__loop_8c_a8096732d061a4d6d6a9b78780025f056}{T\+\_\+\+R\+EQ}} = 0
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
File containing the meat and potatoes driving loop thread, and all supporting functions. 



\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{driving__loop_8c_a3fa2d9e8a3ff5bc7ac576fda26265b44}\label{driving__loop_8c_a3fa2d9e8a3ff5bc7ac576fda26265b44}} 
\index{driving\_loop.c@{driving\_loop.c}!ACCELERATION@{ACCELERATION}}
\index{ACCELERATION@{ACCELERATION}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{ACCELERATION}{ACCELERATION}}
{\footnotesize\ttfamily \#define A\+C\+C\+E\+L\+E\+R\+A\+T\+I\+ON~0}



Definition at line 100 of file driving\+\_\+loop.\+c.

\mbox{\Hypertarget{driving__loop_8c_a7c627c95d1731c3c24a41b8aa86a5fd5}\label{driving__loop_8c_a7c627c95d1731c3c24a41b8aa86a5fd5}} 
\index{driving\_loop.c@{driving\_loop.c}!AUTOCROSS@{AUTOCROSS}}
\index{AUTOCROSS@{AUTOCROSS}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{AUTOCROSS}{AUTOCROSS}}
{\footnotesize\ttfamily \#define A\+U\+T\+O\+C\+R\+O\+SS~1}



Definition at line 101 of file driving\+\_\+loop.\+c.

\mbox{\Hypertarget{driving__loop_8c_a64a87e1f80735e94aac871db572dda97}\label{driving__loop_8c_a64a87e1f80735e94aac871db572dda97}} 
\index{driving\_loop.c@{driving\_loop.c}!ENDURANCE@{ENDURANCE}}
\index{ENDURANCE@{ENDURANCE}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{ENDURANCE}{ENDURANCE}}
{\footnotesize\ttfamily \#define E\+N\+D\+U\+R\+A\+N\+CE~2}



Definition at line 102 of file driving\+\_\+loop.\+c.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{driving__loop_8c_a42c4321a28da09906e185c9c5971fce9}\label{driving__loop_8c_a42c4321a28da09906e185c9c5971fce9}} 
\index{driving\_loop.c@{driving\_loop.c}!applyTorqueFilter@{applyTorqueFilter}}
\index{applyTorqueFilter@{applyTorqueFilter}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{applyTorqueFilter()}{applyTorqueFilter()}}
{\footnotesize\ttfamily static float apply\+Torque\+Filter (\begin{DoxyParamCaption}\item[{float}]{T\+\_\+req,  }\item[{float}]{T\+\_\+prev,  }\item[{\mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}}}]{is\+\_\+accelearting }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Applies filtering to smooth torque transitions. 

Rachan 
\begin{DoxyParams}{Parameters}
{\em T\+\_\+req} & Requested torque before filtering. \\
\hline
{\em T\+\_\+prev} & Previous filtered torque value.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Smoothed torque value. 
\end{DoxyReturn}


Definition at line 149 of file driving\+\_\+loop.\+c.



References get\+K\+Value(), and is\+\_\+accelerating.

\mbox{\Hypertarget{driving__loop_8c_ad5227d6e3a1f9c241f31f07abe9f1695}\label{driving__loop_8c_ad5227d6e3a1f9c241f31f07abe9f1695}} 
\index{driving\_loop.c@{driving\_loop.c}!calculateThrottlePercentage@{calculateThrottlePercentage}}
\index{calculateThrottlePercentage@{calculateThrottlePercentage}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{calculateThrottlePercentage()}{calculateThrottlePercentage()}}
{\footnotesize\ttfamily float calculate\+Throttle\+Percentage (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{apps1,  }\item[{uint16\+\_\+t}]{apps2 }\end{DoxyParamCaption})}



Definition at line 117 of file driving\+\_\+loop.\+c.



References driving\+\_\+args, driving\+\_\+loop\+\_\+args\+::max\+\_\+apps1\+\_\+value, driving\+\_\+loop\+\_\+args\+::max\+\_\+apps2\+\_\+value, and driving\+\_\+loop\+\_\+args\+::min\+\_\+apps1\+\_\+value.

\mbox{\Hypertarget{driving__loop_8c_abdfd52d179ac8c6707ea8e0ddb98b7cd}\label{driving__loop_8c_abdfd52d179ac8c6707ea8e0ddb98b7cd}} 
\index{driving\_loop.c@{driving\_loop.c}!getKValue@{getKValue}}
\index{getKValue@{getKValue}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{getKValue()}{getKValue()}}
{\footnotesize\ttfamily float get\+K\+Value (\begin{DoxyParamCaption}\item[{int}]{race\+Mode }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 105 of file driving\+\_\+loop.\+c.



References A\+C\+C\+E\+L\+E\+R\+A\+T\+I\+ON, A\+U\+T\+O\+C\+R\+O\+SS, and E\+N\+D\+U\+R\+A\+N\+CE.



Referenced by apply\+Torque\+Filter().

\mbox{\Hypertarget{driving__loop_8c_af580185fb5bb1cfba30ee1709d90628c}\label{driving__loop_8c_af580185fb5bb1cfba30ee1709d90628c}} 
\index{driving\_loop.c@{driving\_loop.c}!initDrivingLoop@{initDrivingLoop}}
\index{initDrivingLoop@{initDrivingLoop}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{initDrivingLoop()}{initDrivingLoop()}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{uvfr__utils_8h_a71c52c44be11d0980910401cb9b5fb9e}{uv\+\_\+status\+\_\+t}} init\+Driving\+Loop (\begin{DoxyParamCaption}\item[{void $\ast$}]{argument }\end{DoxyParamCaption})}



Definition at line 42 of file driving\+\_\+loop.\+c.



References uv\+\_\+task\+\_\+info\+::active\+\_\+states, adc1\+\_\+\+A\+P\+P\+S1, adc1\+\_\+\+A\+P\+P\+S2, adc1\+\_\+\+B\+P\+S1, adc1\+\_\+\+B\+P\+S2, A\+P\+P\+S1\+\_\+\+A\+D\+C\+\_\+\+V\+AL, A\+P\+P\+S2\+\_\+\+A\+D\+C\+\_\+\+V\+AL, associate\+Daq\+Param\+With\+Var(), B\+P\+S1\+\_\+\+A\+D\+C\+\_\+\+V\+AL, B\+P\+S2\+\_\+\+A\+D\+C\+\_\+\+V\+AL, current\+\_\+vehicle\+\_\+settings, uv\+\_\+task\+\_\+info\+::deletion\+\_\+states, driving\+\_\+args, uv\+\_\+vehicle\+\_\+settings\+::driving\+\_\+loop\+\_\+settings, P\+R\+O\+G\+R\+A\+M\+M\+I\+NG, uv\+\_\+task\+\_\+info\+::stack\+\_\+size, Start\+Driving\+Loop(), uv\+\_\+task\+\_\+info\+::suspension\+\_\+states, uv\+\_\+task\+\_\+info\+::task\+\_\+args, uv\+\_\+task\+\_\+info\+::task\+\_\+function, uv\+\_\+task\+\_\+info\+::task\+\_\+name, uv\+\_\+task\+\_\+info\+::task\+\_\+period, uv\+\_\+task\+\_\+info\+::task\+\_\+priority, U\+V\+\_\+\+D\+R\+I\+V\+I\+NG, U\+V\+\_\+\+E\+R\+R\+OR, U\+V\+\_\+\+E\+R\+R\+O\+R\+\_\+\+S\+T\+A\+TE, U\+V\+\_\+\+I\+N\+IT, U\+V\+\_\+\+L\+A\+U\+N\+C\+H\+\_\+\+C\+O\+N\+T\+R\+OL, U\+V\+\_\+\+OK, U\+V\+\_\+\+R\+E\+A\+DY, U\+V\+\_\+\+S\+U\+S\+P\+E\+N\+D\+ED, and uv\+Create\+Task().



Referenced by uv\+Init\+State\+Engine().

\mbox{\Hypertarget{driving__loop_8c_a14bdb2b38c226aa850a0c25207afd1fa}\label{driving__loop_8c_a14bdb2b38c226aa850a0c25207afd1fa}} 
\index{driving\_loop.c@{driving\_loop.c}!mapThrottleToTorque@{mapThrottleToTorque}}
\index{mapThrottleToTorque@{mapThrottleToTorque}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{mapThrottleToTorque()}{mapThrottleToTorque()}}
{\footnotesize\ttfamily static float map\+Throttle\+To\+Torque (\begin{DoxyParamCaption}\item[{float}]{throttle\+\_\+percent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}



Definition at line 87 of file driving\+\_\+loop.\+c.



References driving\+\_\+loop\+\_\+args\+::absolute\+\_\+max\+\_\+motor\+\_\+torque, and driving\+\_\+args.

\mbox{\Hypertarget{driving__loop_8c_ac9c776513f26edd5cf75280eea26275b}\label{driving__loop_8c_ac9c776513f26edd5cf75280eea26275b}} 
\index{driving\_loop.c@{driving\_loop.c}!performSafetyChecks@{performSafetyChecks}}
\index{performSafetyChecks@{performSafetyChecks}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{performSafetyChecks()}{performSafetyChecks()}}
{\footnotesize\ttfamily \mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} perform\+Safety\+Checks (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structdriving__loop__args}{driving\+\_\+loop\+\_\+args}} $\ast$}]{dl\+\_\+params,  }\item[{uint16\+\_\+t}]{apps1\+\_\+value,  }\item[{uint16\+\_\+t}]{apps2\+\_\+value,  }\item[{uint16\+\_\+t}]{bps1\+\_\+value,  }\item[{uint16\+\_\+t}]{bps2\+\_\+value,  }\item[{enum \mbox{\hyperlink{driving__loop_8h_adef4571b048b5b1f2b712713741296c7}{D\+L\+\_\+internal\+\_\+state}} $\ast$}]{dl\+\_\+status }\end{DoxyParamCaption})}



Converts A\+P\+PS sensor readings into a throttle percentage. 

rachan 
\begin{DoxyParams}{Parameters}
{\em apps1} & Raw voltage value from A\+P\+P\+S1 sensor \\
\hline
{\em apps2} & Raw voltage value from A\+P\+P\+S2 sensor\\
\hline
\end{DoxyParams}
TO DO\+: Set R\+P\+M\+\_\+\+M\+AX \& R\+P\+M\+\_\+\+M\+IN \begin{DoxyReturn}{Returns}
Throttle percentage (0\% to 100\%). A\+M\+M\+AR
\end{DoxyReturn}
Maps Throttle Percentage to Torque Request. Call the calculate\+Throttle\+Percentage function to get the value 
\begin{DoxyParams}{Parameters}
{\em throttle\+\_\+percent} & Throttle percentage (0\% -\/ 100\%).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Requested torque in Nm. 
\end{DoxyReturn}


Definition at line 452 of file driving\+\_\+loop.\+c.



Referenced by Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_a1eee9dfaef3aaaf010bd8bb12fa20fc3}\label{driving__loop_8c_a1eee9dfaef3aaaf010bd8bb12fa20fc3}} 
\index{driving\_loop.c@{driving\_loop.c}!sendTorqueToMotorController@{sendTorqueToMotorController}}
\index{sendTorqueToMotorController@{sendTorqueToMotorController}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{sendTorqueToMotorController()}{sendTorqueToMotorController()}}
{\footnotesize\ttfamily static void send\+Torque\+To\+Motor\+Controller (\begin{DoxyParamCaption}\item[{float}]{T\+\_\+filtered }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Sends the filtered torque value to the motor controller. 

Rachan 
\begin{DoxyParams}{Parameters}
{\em T\+\_\+filtered} & Final torque value after filtering. \\
\hline
\end{DoxyParams}


Definition at line 182 of file driving\+\_\+loop.\+c.



References Motor\+Controller\+Spin\+Test().

\mbox{\Hypertarget{driving__loop_8c_a80cc48f06202edc29bcad26a956bcc98}\label{driving__loop_8c_a80cc48f06202edc29bcad26a956bcc98}} 
\index{driving\_loop.c@{driving\_loop.c}!StartDrivingLoop@{StartDrivingLoop}}
\index{StartDrivingLoop@{StartDrivingLoop}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{StartDrivingLoop()}{StartDrivingLoop()}}
{\footnotesize\ttfamily void Start\+Driving\+Loop (\begin{DoxyParamCaption}\item[{void $\ast$}]{argument }\end{DoxyParamCaption})}



Function implementing the led\+Task thread. 


\begin{DoxyParams}{Parameters}
{\em argument} & Not used for now. Will have configuration settings later. \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em None} & This function is made to be the meat and potatoes of the entire vehicle. \\
\hline
\end{DoxyRetVals}
The first thing we do here is create some local variables here, to cache whatever variables need cached. We will be caching variables that are used very frequently in every single loop iteration, and are not

This line extracts the specific driving loop parameters as specified in the vehicle settings 
\begin{DoxyCode}{0}
\DoxyCodeLine{ */}
\DoxyCodeLine{\mbox{\hyperlink{structdriving__loop__args}{driving\_loop\_args}}* dl\_params = (\mbox{\hyperlink{structdriving__loop__args}{driving\_loop\_args}}*) params-\/>task\_args;}
\DoxyCodeLine{\textcolor{comment}{/**}}
\end{DoxyCode}


These here lines set the delay. This task executes exactly at the period specified, regardless of how long the task execution actually takes rachan\+: ensures the function runs exactly 100ms, regardless of execution time.


\begin{DoxyCode}{0}
\DoxyCodeLine{ */}
\DoxyCodeLine{TickType\_t tick\_period = pdMS\_TO\_TICKS(params-\/>task\_period); \textcolor{comment}{//Convert ms of period to the RTOS ticks}}
\DoxyCodeLine{TickType\_t last\_time = xTaskGetTickCount();}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{/**}}
\end{DoxyCode}


Performs safety checks on A\+P\+PS (Throttle) and B\+PS (Brake) sensors.

This function ensures that\+:
\begin{DoxyItemize}
\item Throttle position sensors (A\+P\+P\+S1 \& A\+P\+P\+S2) are within 10\% of each other.
\item Brake pressure sensors (B\+P\+S1 \& B\+P\+S2) are within 5\% of each other.
\item Sensors are within their expected min/max ranges.
\item Brake and throttle are not pressed at the same time.
\end{DoxyItemize}

If a {\bfseries{fatal error}} is detected (e.\+g., sensor out of range), the function\+:
\begin{DoxyItemize}
\item {\bfseries{Stops the motor}}.
\item {\bfseries{Kills the task execution}} ({\ttfamily \mbox{\hyperlink{group__state__engine__backend_ga5f35b34432afed7f18f91fb8607f096f}{kill\+Self()}}}).
\end{DoxyItemize}

If a {\bfseries{non-\/fatal error}} occurs (e.\+g., sensor mismatch exceeding the limit)\+:
\begin{DoxyItemize}
\item {\bfseries{Stops the motor}}.
\item {\bfseries{Suspends the task temporarily}} ({\ttfamily \mbox{\hyperlink{group__state__engine__backend_gad6117850b55ad52be51d93915bcc313c}{suspend\+Self()}}}).
\end{DoxyItemize}

If safety conditions return to normal, the function\+:
\begin{DoxyItemize}
\item {\bfseries{Restarts the motor}}.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em dl\+\_\+params} & Pointer to the driving loop parameters. \\
\hline
{\em apps1\+\_\+value} & Raw sensor reading from A\+P\+P\+S1. \\
\hline
{\em apps2\+\_\+value} & Raw sensor reading from A\+P\+P\+S2. \\
\hline
{\em bps1\+\_\+value} & Raw sensor reading from B\+P\+S1. \\
\hline
{\em bps2\+\_\+value} & Raw sensor reading from B\+P\+S2. \\
\hline
{\em params} & Pointer to the current task information. \\
\hline
{\em dl\+\_\+status} & Pointer to the driving loop internal state.\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em true} & All safety checks passed. \\
\hline
{\em false} & One or more safety checks failed.\\
\hline
\end{DoxyRetVals}


Definition at line 194 of file driving\+\_\+loop.\+c.



References adc1\+\_\+\+A\+P\+P\+S1, adc1\+\_\+\+A\+P\+P\+S2, adc1\+\_\+\+B\+P\+S1, adc1\+\_\+\+B\+P\+S2, uv\+\_\+task\+\_\+info\+::cmd\+\_\+data, is\+\_\+accelerating, kill\+Self(), perform\+Safety\+Checks(), Plausible, suspend\+Self(), T\+\_\+\+P\+R\+EV, T\+\_\+\+R\+EQ, uv\+\_\+task\+\_\+info\+::task\+\_\+args, uv\+\_\+task\+\_\+info\+::task\+\_\+period, U\+V\+\_\+\+K\+I\+L\+L\+\_\+\+C\+MD, and U\+V\+\_\+\+S\+U\+S\+P\+E\+N\+D\+\_\+\+C\+MD.



Referenced by init\+Driving\+Loop().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{driving__loop_8c_a549b3590f54dfc129d2eebf2604c16e8}\label{driving__loop_8c_a549b3590f54dfc129d2eebf2604c16e8}} 
\index{driving\_loop.c@{driving\_loop.c}!adc1\_APPS1@{adc1\_APPS1}}
\index{adc1\_APPS1@{adc1\_APPS1}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{adc1\_APPS1}{adc1\_APPS1}}
{\footnotesize\ttfamily uint16\+\_\+t adc1\+\_\+\+A\+P\+P\+S1}



Definition at line 64 of file main.\+c.



Referenced by H\+A\+L\+\_\+\+A\+D\+C\+\_\+\+Level\+Out\+Of\+Window\+Callback(), init\+Driving\+Loop(), main(), and Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_a8567d6e2f5ad8bd53f71ecc2b2b0ae30}\label{driving__loop_8c_a8567d6e2f5ad8bd53f71ecc2b2b0ae30}} 
\index{driving\_loop.c@{driving\_loop.c}!adc1\_APPS2@{adc1\_APPS2}}
\index{adc1\_APPS2@{adc1\_APPS2}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{adc1\_APPS2}{adc1\_APPS2}}
{\footnotesize\ttfamily uint16\+\_\+t adc1\+\_\+\+A\+P\+P\+S2}



Definition at line 65 of file main.\+c.



Referenced by H\+A\+L\+\_\+\+A\+D\+C\+\_\+\+Level\+Out\+Of\+Window\+Callback(), init\+Driving\+Loop(), main(), and Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_ad36d3aa4037203058df6816d56f4c186}\label{driving__loop_8c_ad36d3aa4037203058df6816d56f4c186}} 
\index{driving\_loop.c@{driving\_loop.c}!adc1\_BPS1@{adc1\_BPS1}}
\index{adc1\_BPS1@{adc1\_BPS1}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{adc1\_BPS1}{adc1\_BPS1}}
{\footnotesize\ttfamily uint16\+\_\+t adc1\+\_\+\+B\+P\+S1}



Definition at line 66 of file main.\+c.



Referenced by init\+Driving\+Loop(), and Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_a277f7921a7a1e0fb8a6f953943dc06dc}\label{driving__loop_8c_a277f7921a7a1e0fb8a6f953943dc06dc}} 
\index{driving\_loop.c@{driving\_loop.c}!adc1\_BPS2@{adc1\_BPS2}}
\index{adc1\_BPS2@{adc1\_BPS2}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{adc1\_BPS2}{adc1\_BPS2}}
{\footnotesize\ttfamily uint16\+\_\+t adc1\+\_\+\+B\+P\+S2}



Definition at line 67 of file main.\+c.



Referenced by init\+Driving\+Loop(), and Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_ab8788a0f246816c11002008cb43d1886}\label{driving__loop_8c_ab8788a0f246816c11002008cb43d1886}} 
\index{driving\_loop.c@{driving\_loop.c}!default\_dl\_settings@{default\_dl\_settings}}
\index{default\_dl\_settings@{default\_dl\_settings}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{default\_dl\_settings}{default\_dl\_settings}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdriving__loop__args}{driving\+\_\+loop\+\_\+args}} default\+\_\+dl\+\_\+settings}



Definition at line 27 of file driving\+\_\+loop.\+c.



Referenced by setup\+Default\+Settings(), and uv\+Reset\+Flash\+To\+Default().

\mbox{\Hypertarget{driving__loop_8c_a401dd8422f51d8d344e5ac9559ef8908}\label{driving__loop_8c_a401dd8422f51d8d344e5ac9559ef8908}} 
\index{driving\_loop.c@{driving\_loop.c}!driving\_args@{driving\_args}}
\index{driving\_args@{driving\_args}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{driving\_args}{driving\_args}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdriving__loop__args}{driving\+\_\+loop\+\_\+args}}$\ast$ driving\+\_\+args = N\+U\+LL}



Definition at line 29 of file driving\+\_\+loop.\+c.



Referenced by calculate\+Throttle\+Percentage(), init\+Driving\+Loop(), and map\+Throttle\+To\+Torque().

\mbox{\Hypertarget{driving__loop_8c_a15e200c9bf4f5d49b02215e273d2d841}\label{driving__loop_8c_a15e200c9bf4f5d49b02215e273d2d841}} 
\index{driving\_loop.c@{driving\_loop.c}!is\_accelerating@{is\_accelerating}}
\index{is\_accelerating@{is\_accelerating}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{is\_accelerating}{is\_accelerating}}
{\footnotesize\ttfamily \mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} is\+\_\+accelerating = \mbox{\hyperlink{group__utility__macros_ga65e9886d74aaee76545e83dd09011727}{false}}}



Definition at line 34 of file driving\+\_\+loop.\+c.



Referenced by apply\+Torque\+Filter(), and Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_afb126e9ab9acbc2c02585ce5728a538a}\label{driving__loop_8c_afb126e9ab9acbc2c02585ce5728a538a}} 
\index{driving\_loop.c@{driving\_loop.c}!T\_PREV@{T\_PREV}}
\index{T\_PREV@{T\_PREV}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{T\_PREV}{T\_PREV}}
{\footnotesize\ttfamily float T\+\_\+\+P\+R\+EV = 0}



Definition at line 35 of file driving\+\_\+loop.\+c.



Referenced by Start\+Driving\+Loop().

\mbox{\Hypertarget{driving__loop_8c_a8096732d061a4d6d6a9b78780025f056}\label{driving__loop_8c_a8096732d061a4d6d6a9b78780025f056}} 
\index{driving\_loop.c@{driving\_loop.c}!T\_REQ@{T\_REQ}}
\index{T\_REQ@{T\_REQ}!driving\_loop.c@{driving\_loop.c}}
\doxysubsubsection{\texorpdfstring{T\_REQ}{T\_REQ}}
{\footnotesize\ttfamily float T\+\_\+\+R\+EQ = 0}



Definition at line 36 of file driving\+\_\+loop.\+c.



Referenced by Start\+Driving\+Loop().

