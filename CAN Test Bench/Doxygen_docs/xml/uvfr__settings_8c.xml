<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.16">
  <compounddef id="uvfr__settings_8c" kind="file" language="C++">
    <compoundname>uvfr_settings.c</compoundname>
    <includes refid="uvfr__utils_8h" local="yes">uvfr_utils.h</includes>
    <includes refid="main_8h" local="yes">main.h</includes>
    <includes local="yes">stdlib.h</includes>
    <incdepgraph>
      <node id="6">
        <label>stdarg.h</label>
      </node>
      <node id="12">
        <label>tim.h</label>
        <link refid="tim_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>imd.h</label>
        <link refid="imd_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>dash.h</label>
        <link refid="dash_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>driving_loop.h</label>
        <link refid="driving__loop_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>temp_monitoring.h</label>
        <link refid="temp__monitoring_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="32">
        <label>stdint.h</label>
      </node>
      <node id="33">
        <label>stdlib.h</label>
      </node>
      <node id="28">
        <label>oled.h</label>
        <link refid="oled_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>adc.h</label>
        <link refid="adc_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>cmsis_os.h</label>
      </node>
      <node id="2">
        <label>uvfr_utils.h</label>
        <link refid="uvfr__utils_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>message_buffer.h</label>
      </node>
      <node id="23">
        <label>bms.h</label>
        <link refid="bms_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>Core/Src/uvfr_settings.c</label>
        <link refid="uvfr__settings_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>spi.h</label>
        <link refid="spi_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>pdu.h</label>
        <link refid="pdu_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>motor_controller.h</label>
        <link refid="motor__controller_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>uvfr_settings.h</label>
        <link refid="uvfr__settings_8h"/>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>daq.h</label>
        <link refid="daq_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>gpio.h</label>
        <link refid="gpio_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>rb_tree.h</label>
        <link refid="rb__tree_8h"/>
      </node>
      <node id="10">
        <label>constants.h</label>
        <link refid="constants_8h"/>
      </node>
      <node id="9">
        <label>can.h</label>
        <link refid="can_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>uvfr_global_config.h</label>
        <link refid="uvfr__global__config_8h"/>
      </node>
      <node id="31">
        <label>FreeRTOSConfig.h</label>
        <link refid="_free_r_t_o_s_config_8h"/>
      </node>
      <node id="24">
        <label>uvfr_state_engine.h</label>
        <link refid="uvfr__state__engine_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="30">
        <label>odometer.h</label>
        <link refid="odometer_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>stm32f4xx_hal.h</label>
      </node>
      <node id="15">
        <label>FreeRTOS.h</label>
      </node>
      <node id="11">
        <label>dma.h</label>
        <link refid="dma_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>task.h</label>
      </node>
      <node id="4">
        <label>main.h</label>
        <link refid="main_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="structtx__all__settings__args" prot="public">tx_all_settings_args</innerclass>
    <innerclass refid="structtx__journal__args" prot="public">tx_journal_args</innerclass>
    <innerclass refid="unionhelper__task__args" prot="public">helper_task_args</innerclass>
    <innerclass refid="structsetting__helper__task" prot="public">setting_helper_task</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="uvfr__settings_8c_1a7350f4a84cab7a08d99c9e88b248a180" prot="public" static="no">
        <name>SRC_UVFR_SETTINGS_C_</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="7" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="7" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a9320db4d0509341600bb7584ca595609" prot="public" static="no">
        <name>VCU_TO_LAPTOP_ID</name>
        <initializer>0x420</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="13" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="13" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1aaa6ee3d8e77c95b379e21d4b827ad783" prot="public" static="no">
        <name>LAPTOP_TO_VCU_ID</name>
        <initializer>0x520</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="14" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="14" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a65bd5632c9f844eac3ead2787cb1375c" prot="public" static="no">
        <name>FLASH_OK</name>
        <initializer>0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>These defines are for the return error code of the next function </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="563" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="563" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" prot="public" static="no">
        <name>INVALID_SBLOCK</name>
        <initializer>1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="564" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="564" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" prot="public" static="no">
        <name>FLASH_NOT_UNLOCKED</name>
        <initializer>2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="565" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="565" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" prot="public" static="no">
        <name>DID_NOT_FINISH_PROGRAMMING</name>
        <initializer>3</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="566" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="566" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" prot="public" static="no">
        <name>DATA_MISMATCH</name>
        <initializer>4</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="567" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="567" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a4fc65d72946e3e169f15ed0015fa3d3c" prot="public" static="no">
        <name>PRE_CHECKSUM</name>
        <initializer>5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="568" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="568" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="uvfr__settings_8c_1a1e63b2fed237e9d016b304884c01457b" prot="public" static="no">
        <name>POST_CHECKSUM</name>
        <initializer>6</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="569" column="9" bodyfile="Core/Src/uvfr_settings.c" bodystart="569" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="uvfr__settings_8c_1a0641c122dc09626011ee339625d1ea63" prot="public" static="no">
        <type>struct <ref refid="structtx__all__settings__args" kindref="compound">tx_all_settings_args</ref></type>
        <definition>typedef struct tx_all_settings_args tx_all_settings_args</definition>
        <argsstring></argsstring>
        <name>tx_all_settings_args</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>These are arguments passed to the &quot;Transmit All Settings Over CANbus&quot; Subroutine. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="38" column="21"/>
      </memberdef>
      <memberdef kind="typedef" id="uvfr__settings_8c_1a9a7490c87797ddce618071ea477c8009" prot="public" static="no">
        <type>struct <ref refid="structtx__journal__args" kindref="compound">tx_journal_args</ref></type>
        <definition>typedef struct tx_journal_args tx_journal_args</definition>
        <argsstring></argsstring>
        <name>tx_journal_args</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="46" column="16"/>
      </memberdef>
      <memberdef kind="typedef" id="uvfr__settings_8c_1a06b8e5486501c8fe34e2a1c669e4a01c" prot="public" static="no">
        <type>union <ref refid="unionhelper__task__args" kindref="compound">helper_task_args</ref></type>
        <definition>typedef union helper_task_args helper_task_args</definition>
        <argsstring></argsstring>
        <name>helper_task_args</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="54" column="17"/>
      </memberdef>
      <memberdef kind="typedef" id="uvfr__settings_8c_1aff5e0078d7c880f42cc79e084141a6bd" prot="public" static="no">
        <type>struct <ref refid="structsetting__helper__task" kindref="compound">setting_helper_task</ref></type>
        <definition>typedef struct setting_helper_task setting_helper_task</definition>
        <argsstring></argsstring>
        <name>setting_helper_task</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="67" column="20"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="uvfr__settings_8c_1a7c9185b38cc68d3a0c2c205746d25494" prot="public" static="no" mutable="no">
        <type>PRIVILEGED_DATA uint8_t</type>
        <definition>PRIVILEGED_DATA uint8_t _s_uvdata</definition>
        <argsstring></argsstring>
        <name>_s_uvdata</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="16" column="32" declfile="Core/Src/uvfr_settings.c" declline="16" declcolumn="32"/>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a32dcb66c3240af325158ccd12dcb3c68" prot="public" static="no" mutable="no">
        <type>PRIVILEGED_DATA uint8_t</type>
        <definition>PRIVILEGED_DATA uint8_t _e_uvdata</definition>
        <argsstring></argsstring>
        <name>_e_uvdata</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="17" column="32" declfile="Core/Src/uvfr_settings.c" declline="17" declcolumn="32"/>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" prot="public" static="no" mutable="no">
        <type><ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref> *</type>
        <definition>uv_vehicle_settings* current_vehicle_settings</definition>
        <argsstring></argsstring>
        <name>current_vehicle_settings</name>
        <initializer>= NULL</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="20" column="21" bodyfile="Core/Src/uvfr_settings.c" bodystart="20" bodyend="-1"/>
        <referencedby refid="daq_8c_1a9e1cd582f8748d018266ba4ab15561ae" compoundref="daq_8c" startline="184" endline="206">configureDaqSubTasks</referencedby>
        <referencedby refid="daq_8c_1af2c619df9f3d115dcbc511b0bb738e87" compoundref="daq_8c" startline="252" endline="286">initDaqTask</referencedby>
        <referencedby refid="driving__loop_8c_1af580185fb5bb1cfba30ee1709d90628c" compoundref="driving__loop_8c" startline="42" endline="85">initDrivingLoop</referencedby>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__utils_8c_1a6d40598f9d8daa89ca159a2e87f4fd01" compoundref="uvfr__utils_8c" startline="46" endline="253">uvInit</referencedby>
        <referencedby refid="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" compoundref="uvfr__settings_8c" startline="274" endline="299">uvLoadSettingsFromFlash</referencedby>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
        <referencedby refid="group__state__engine__api_1ga2ad1d74b5783a51355c047be6642fab8" compoundref="uvfr__state__engine_8c" startline="200" endline="254">uvStartStateMachine</referencedby>
      </memberdef>
      <memberdef kind="variable" id="group__state__engine_1gad9e02be6d2d0bc1ab5cd9fd8cae34230" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref></type>
        <definition>struct uv_os_settings default_os_settings</definition>
        <argsstring></argsstring>
        <name>default_os_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="20" column="21" bodyfile="Core/Src/uvfr_state_engine.c" bodystart="57" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="20" declcolumn="21"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a1c7fecf890841f27a4ca39fc66e8cc1b" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref></type>
        <definition>struct motor_controller_settings mc_default_settings</definition>
        <argsstring></argsstring>
        <name>mc_default_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="20" column="21" bodyfile="Core/Src/motor_controller.c" bodystart="14" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="20" declcolumn="21"/>
        <referencedby refid="motor__controller_8c_1af6b3a4911f1bdac54d84b4dcc7b7ec4a" compoundref="motor__controller_8c" startline="63" endline="78">MC_Request_Data</referencedby>
        <referencedby refid="motor__controller_8c_1a37f4a694fab82b650c96c13fe4894143" compoundref="motor__controller_8c" startline="80" endline="96">MC_Set_Param</referencedby>
        <referencedby refid="motor__controller_8c_1aed1407e1e0fd59dc7c5e5d6db671f0ab" compoundref="motor__controller_8c" startline="278" endline="326">MC_Startup</referencedby>
        <referencedby refid="motor__controller_8c_1ad9944bce211ed6594929c3acf72e3881" compoundref="motor__controller_8c" startline="30" endline="56">MotorControllerSpinTest</referencedby>
        <referencedby refid="motor__controller_8c_1a98ef1edcc51198faf53767e8d92ce4c9" compoundref="motor__controller_8c" startline="104" endline="137">Parse_Bamocar_Response</referencedby>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a44daa1a9c68be860616e7bc627d9b8f4" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structdriving__loop__args" kindref="compound">driving_loop_args</ref></type>
        <definition>struct driving_loop_args default_dl_settings</definition>
        <argsstring></argsstring>
        <name>default_dl_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="20" column="21" bodyfile="Core/Src/driving_loop.c" bodystart="27" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="20" declcolumn="21"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref></type>
        <definition>struct daq_loop_args default_daq_settings</definition>
        <argsstring></argsstring>
        <name>default_daq_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="20" column="21" bodyfile="Core/Src/daq.c" bodystart="30" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="20" declcolumn="21"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a1071bc1cceac3198de98d9c0753044d6" prot="public" static="no" mutable="no">
        <type>struct <ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref></type>
        <definition>struct uv_imd_settings default_imd_settings</definition>
        <argsstring></argsstring>
        <name>default_imd_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="20" column="21" bodyfile="Core/Src/imd.c" bodystart="65" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="20" declcolumn="21"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a28e4314b233b9140e73e4fd0bab7e354" prot="public" static="no" mutable="no">
        <type><ref refid="structbms__settings__t" kindref="compound">bms_settings_t</ref></type>
        <definition>bms_settings_t default_bms_settings</definition>
        <argsstring></argsstring>
        <name>default_bms_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="27" column="23" bodyfile="Core/Src/bms.c" bodystart="12" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="27" declcolumn="23"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" prot="public" static="no" mutable="no">
        <type><ref refid="structuv19__pdu__settings" kindref="compound">uv19_pdu_settings</ref></type>
        <definition>uv19_pdu_settings default_pdu_settings</definition>
        <argsstring></argsstring>
        <name>default_pdu_settings</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="28" column="19" bodyfile="Core/Src/uvfr_settings.c" bodystart="28" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1af5ab2cd7ec858145d49d4e585e4bef94" prot="public" static="no" mutable="no">
        <type><ref refid="structdaq__datapoint" kindref="compound">daq_datapoint</ref></type>
        <definition>daq_datapoint default_datapoints[]</definition>
        <argsstring>[]</argsstring>
        <name>default_datapoints</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="29" column="22" bodyfile="Core/Src/daq.c" bodystart="38" bodyend="-1" declfile="Core/Src/uvfr_settings.c" declline="29" declcolumn="22"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" prot="public" static="no" mutable="no">
        <type><ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref></type>
        <definition>veh_gen_info default_vehicle</definition>
        <argsstring></argsstring>
        <name>default_vehicle</name>
        <initializer>= {
	.wheel_size = 0xEEEEEEEE,
	.drive_ratio = 0xDDDDDDDD,
	.test1 = 0xCCCC,
	.test2 = 0xBBBB,
	.test3 = 0xAAAA,
	.test4 = 0x99,
	.test5 = 0x88,
	.test6 = 0x77777777
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="72" column="14" bodyfile="Core/Src/uvfr_settings.c" bodystart="72" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</referencedby>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1ad566fc47eb8eb3464e5b48f088ddbb83" prot="public" static="yes" mutable="no">
        <type><ref refid="uvfr__utils_8h_1a0ecf26b576b9a54eca656b9be7ba6a06" kindref="member">bool</ref></type>
        <definition>bool is_laptop_connected</definition>
        <argsstring></argsstring>
        <name>is_laptop_connected</name>
        <initializer>= <ref refid="group__utility__macros_1ga65e9886d74aaee76545e83dd09011727" kindref="member">false</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="84" column="13" bodyfile="Core/Src/uvfr_settings.c" bodystart="84" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" compoundref="uvfr__settings_8c" startline="152" endline="226">handleIncomingLaptopMsg</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" prot="public" static="no" mutable="no">
        <type>TickType_t</type>
        <definition>TickType_t last_contact_with_laptop</definition>
        <argsstring></argsstring>
        <name>last_contact_with_laptop</name>
        <initializer>= 0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="85" column="12" bodyfile="Core/Src/uvfr_settings.c" bodystart="85" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" compoundref="uvfr__settings_8c" startline="152" endline="226">handleIncomingLaptopMsg</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" prot="public" static="yes" mutable="no">
        <type>QueueHandle_t</type>
        <definition>QueueHandle_t settings_queue</definition>
        <argsstring></argsstring>
        <name>settings_queue</name>
        <initializer>= NULL</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="88" column="22" bodyfile="Core/Src/uvfr_settings.c" bodystart="88" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" compoundref="uvfr__settings_8c" startline="152" endline="226">handleIncomingLaptopMsg</referencedby>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a6726b669a3c5795c3326238ab974f382" prot="public" static="yes" mutable="no">
        <type>TaskHandle_t</type>
        <definition>TaskHandle_t ptask_handle</definition>
        <argsstring></argsstring>
        <name>ptask_handle</name>
        <initializer>= NULL</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="90" column="21" bodyfile="Core/Src/uvfr_settings.c" bodystart="90" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1a19de39f55cc05851f5fa6a40070681e3" prot="public" static="yes" mutable="no">
        <type>TaskHandle_t</type>
        <definition>TaskHandle_t child_task_handle</definition>
        <argsstring></argsstring>
        <name>child_task_handle</name>
        <initializer>= NULL</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="92" column="21" bodyfile="Core/Src/uvfr_settings.c" bodystart="92" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1a4610dbfba4a1c427386d906bfc656b77" compoundref="uvfr__settings_8c" startline="1163" endline="1220">sendAllSettingsWorker</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1af0cbf7f4ea57695f3b1d2d3c83844000" prot="public" static="yes" mutable="no">
        <type><ref refid="uvfr__utils_8h_1a0ecf26b576b9a54eca656b9be7ba6a06" kindref="member">bool</ref></type>
        <definition>bool child_task_active</definition>
        <argsstring></argsstring>
        <name>child_task_active</name>
        <initializer>= <ref refid="group__utility__macros_1ga65e9886d74aaee76545e83dd09011727" kindref="member">false</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="93" column="13" bodyfile="Core/Src/uvfr_settings.c" bodystart="93" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1a4610dbfba4a1c427386d906bfc656b77" compoundref="uvfr__settings_8c" startline="1163" endline="1220">sendAllSettingsWorker</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" prot="public" static="no" mutable="no">
        <type>const <ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref></type>
        <definition>const uv_CAN_msg vcu_ack_msg</definition>
        <argsstring></argsstring>
        <name>vcu_ack_msg</name>
        <initializer>= {
	.flags = 0x00,
	.dlc = 1,
	.data = {0x10,0,0,0,0,0,0,0},
	.msg_id = <ref refid="uvfr__settings_8c_1a9320db4d0509341600bb7584ca595609" kindref="member">VCU_TO_LAPTOP_ID</ref>
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Pre-create message that is transmitted by the VCU upon successful completion of a settings change or diagnostic operation requested by a laptop </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="100" column="18" bodyfile="Core/Src/uvfr_settings.c" bodystart="100" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="variable" id="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" prot="public" static="no" mutable="no">
        <type>const <ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref></type>
        <definition>const uv_CAN_msg vcu_ack_failed_msg</definition>
        <argsstring></argsstring>
        <name>vcu_ack_failed_msg</name>
        <initializer>= {
	.flags = 0x00,
	.dlc = 1,
	.data = {0x11,0,0,0,0,0,0,0},
	.msg_id = <ref refid="uvfr__settings_8c_1a9320db4d0509341600bb7584ca595609" kindref="member">VCU_TO_LAPTOP_ID</ref>
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Pre-created message that indicates the VCU has failed to perform some requested action </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="111" column="18" bodyfile="Core/Src/uvfr_settings.c" bodystart="111" bodyend="-1"/>
        <referencedby refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" compoundref="uvfr__settings_8c" startline="152" endline="226">handleIncomingLaptopMsg</referencedby>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="uvfr__settings_8c_1a0be2604cded239f54f4f4ab61460a85c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvValidateFlashSettings</definition>
        <argsstring>()</argsstring>
        <name>uvValidateFlashSettings</name>
        <briefdescription>
<para>Function that looks into the flash memory of the VCU, and determines if a valid set of settings exists. </para>
        </briefdescription>
        <detaileddescription>
<para>This checks various parameters to ensure that the settings are useable. The first thing it looks at is the very first word of the SBLOCK. If the first word is 0x42069420, then this is a real sblock.</para>
<para>The second thing it checks is the firmware version, which is stored immediately after the first word, and 16 bytes of padding. These 3 16 bit ints need to be correct, in order for it to proceed. This prevents settings made for incompatible firmware versions from being used. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="810" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="810" bodyend="857" declfile="Core/Src/uvfr_settings.c" declline="121" declcolumn="11"/>
        <references refid="uvfr__settings_8h_1a54061e5993a5517320d425f44408cc86" compoundref="uvfr__settings_8h" startline="96">MAGIC_NUMBER</references>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvResetFlashToDefault</definition>
        <argsstring>()</argsstring>
        <name>uvResetFlashToDefault</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="122" column="11" declfile="Core/Src/uvfr_settings.c" declline="122" declcolumn="11"/>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void uvSettingsProgrammerTask</definition>
        <argsstring>(void *args) PRIVILEGED_FUNCTION</argsstring>
        <name>uvSettingsProgrammerTask</name>
        <param>
          <type>void *</type>
          <declname>args</declname>
        </param>
        <briefdescription>
<para>This is a task that executes the functionality necessary for vehicle diagnostics. </para>
        </briefdescription>
        <detaileddescription>
<para>This task is only active once the car has been placed in programming mode. </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="864" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="864" bodyend="1052" declfile="Core/Src/uvfr_settings.c" declline="123" declcolumn="6"/>
        <references refid="group__state__engine__api_1gaa3ad3e8df75177c00265881c16563212" compoundref="uvfr__state__engine_8c" startline="101" endline="163">changeVehicleState</references>
        <references refid="structuv__task__info_1af532b5031cd6a168a3ec45ab9ead4f23" compoundref="uvfr__state__engine_8h" startline="241">uv_task_info::cmd_data</references>
        <references refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" compoundref="uvfr__utils_8h" startline="277">uv_CAN_msg::data</references>
        <references refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" compoundref="uvfr__settings_8c" startline="567">DATA_MISMATCH</references>
        <references refid="uvfr__utils_8h_1a657e7e858d8847396634fd9912747f8b" compoundref="uvfr__utils_8c" startline="17">data_size</references>
        <references refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" compoundref="uvfr__settings_8c" startline="566">DID_NOT_FINISH_PROGRAMMING</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a485f41f6d806239622abbac7aef60557" compoundref="uvfr__settings_8h" startline="129">DISCARD_NEW_SETTINGS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694abe34f5f2d055215f2ff2e2d85401199a" compoundref="uvfr__settings_8h" startline="130">DISCARD_NEW_SETTINGS_AND_EXIT</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694aefd2ddc079bf62b63b3e5226b9a83ac3" compoundref="uvfr__settings_8h" startline="123">END_OF_SPECIFIC_PARAMS</references>
        <references refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" compoundref="uvfr__settings_8c" startline="565">FLASH_NOT_UNLOCKED</references>
        <references refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" compoundref="uvfr__settings_8h" startline="37">FLASH_SBLOCK_START</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a302a39661f2460e559645419a2ac8258" compoundref="uvfr__settings_8h" startline="131">FORCE_RESTORE_FACTORY_DEFAULT</references>
        <references refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" compoundref="uvfr__settings_8c" startline="564">INVALID_SBLOCK</references>
        <references refid="group__state__engine__backend_1ga5f35b34432afed7f18f91fb8607f096f" compoundref="uvfr__state__engine_8c" startline="717" endline="750">killSelf</references>
        <references refid="uvfr__settings_8c_1a1e63b2fed237e9d016b304884c01457b" compoundref="uvfr__settings_8c" startline="569">POST_CHECKSUM</references>
        <references refid="uvfr__settings_8c_1a4fc65d72946e3e169f15ed0015fa3d3c" compoundref="uvfr__settings_8c" startline="568">PRE_CHECKSUM</references>
        <references refid="uvfr__settings_8c_1a6726b669a3c5795c3326238ab974f382" compoundref="uvfr__settings_8c" startline="90">ptask_handle</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a205322c736d66df92b6d968b53648acb" compoundref="uvfr__settings_8h" startline="125">REQUEST_ALL_JOURNAL_ENTRIES</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a9b0e526098fd6c30dc93538edba59405" compoundref="uvfr__settings_8h" startline="124">REQUEST_ALL_SETTINGS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a4313d65a75fd41f3e527b330e7370a5e" compoundref="uvfr__settings_8h" startline="126">REQUEST_JOURNAL_ENTRIES_BY_TIME</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ac53400ee472ace47006a18aaaa4a86a0" compoundref="uvfr__settings_8h" startline="127">REQUEST_SPECIFIC_SETTING</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a8ad6825ef0a84f2615148dc63202be1f" compoundref="uvfr__settings_8h" startline="128">SAVE_AND_APPLY_NEW_SETTINGS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a7091f0610d47127e952576fcf2d72eac" compoundref="uvfr__settings_8h" startline="122">SET_SPECIFIC_PARAM</references>
        <references refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" compoundref="uvfr__settings_8c" startline="88">settings_queue</references>
        <references refid="structuv__task__info_1a5347f41c4b15b2d6b039c339613fde43" compoundref="uvfr__state__engine_8h" startline="239">uv_task_info::task_handle</references>
        <references refid="group__state__engine__api_1ggaf11e8677926913f2dd803fabbed3455ca0e75e398c2bbcb663eaeb98684ca69d6" compoundref="uvfr__state__engine_8h" startline="98">UV_KILL_CMD</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4a9ec1eef180c6208b25b08f0526dc5eb8" compoundref="uvfr__state__engine_8h" startline="83">UV_READY</references>
        <references refid="uvfr__settings_8c_1a53df36781d38254cb6bbe6717e6ebae0" compoundref="uvfr__settings_8c" startline="756" endline="772">uvCreateTmpSettingsCopy</references>
        <references refid="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87">uvResetFlashToDefault</references>
        <references refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" compoundref="uvfr__settings_8c" startline="574" endline="710">uvSaveSettingsToFlash</references>
        <references refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" compoundref="can_8c" startline="513" endline="554">uvSendCanMSG</references>
        <references refid="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" compoundref="uvfr__settings_8c" startline="778" endline="797">uvSendSpecificParam</references>
        <references refid="uvfr__settings_8c_1adfd1bb6988b37f38e799bb1f996ac005" compoundref="uvfr__settings_8c" startline="411" endline="445">uvUpdateTmpSettings</references>
        <references refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" compoundref="uvfr__settings_8c" startline="111">vcu_ack_failed_msg</references>
        <references refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" compoundref="uvfr__settings_8c" startline="100">vcu_ack_msg</references>
        <referencedby refid="uvfr__settings_8c_1a086bfc48f5a63b15586c6a2a8a1d29a8" compoundref="uvfr__settings_8c" startline="305" endline="328">uvConfigSettingTask</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>static void settingCopy</definition>
        <argsstring>(uint8_t *from, uint8_t *to, uint16_t length) PRIVILEGED_FUNCTION</argsstring>
        <name>settingCopy</name>
        <param>
          <type>uint8_t *</type>
          <declname>from</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>to</declname>
        </param>
        <param>
          <type>uint16_t</type>
          <declname>length</declname>
        </param>
        <briefdescription>
<para>Internal function that is used to copy an arbitrary amount of data from point A to point B. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="128" column="20" bodyfile="Core/Src/uvfr_settings.c" bodystart="128" bodyend="136"/>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1ad2bb778b8a8907a17c87de89f0eea3c0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvTransmitVehicleStatus</definition>
        <argsstring>()</argsstring>
        <name>uvTransmitVehicleStatus</name>
        <briefdescription>
<para>Transmits the status of the vehicle, including errorcodes and similar. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="141" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="141" bodyend="143"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <referencedby refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" compoundref="uvfr__settings_8c" startline="152" endline="226">handleIncomingLaptopMsg</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a66126a25eee9ffcb3c5fa49314fc998b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvAwaitLaptopAckMsg</definition>
        <argsstring>()</argsstring>
        <name>uvAwaitLaptopAckMsg</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="145" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="145" bodyend="147"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea6aa86f67f1dcd70789b27731c3ac4e7a" compoundref="uvfr__utils_8h" startline="170">UV_ABORTED</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void handleIncomingLaptopMsg</definition>
        <argsstring>(uv_CAN_msg *msg) PRIVILEGED_FUNCTION</argsstring>
        <name>handleIncomingLaptopMsg</name>
        <param>
          <type><ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref> *</type>
          <declname>msg</declname>
        </param>
        <briefdescription>
<para>Callback function for event where CAN message is received from laptop. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="152" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="152" bodyend="226"/>
        <references refid="group__state__engine__api_1gaa3ad3e8df75177c00265881c16563212" compoundref="uvfr__state__engine_8c" startline="101" endline="163">changeVehicleState</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ab8a24171d3940ec1ea3160842c3e4b4b" compoundref="uvfr__settings_8h" startline="118">CLEAR_FAULTS</references>
        <references refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" compoundref="uvfr__utils_8h" startline="277">uv_CAN_msg::data</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a485f41f6d806239622abbac7aef60557" compoundref="uvfr__settings_8h" startline="129">DISCARD_NEW_SETTINGS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694abe34f5f2d055215f2ff2e2d85401199a" compoundref="uvfr__settings_8h" startline="130">DISCARD_NEW_SETTINGS_AND_EXIT</references>
        <references refid="structuv___c_a_n__msg_1aa74af3745c8b56910d7c309245541d37" compoundref="uvfr__utils_8h" startline="275">uv_CAN_msg::dlc</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694aefd2ddc079bf62b63b3e5226b9a83ac3" compoundref="uvfr__settings_8h" startline="123">END_OF_SPECIFIC_PARAMS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694aab474c9db56509a37ee4ee2930849b38" compoundref="uvfr__settings_8h" startline="116">ENTER_PROGRAMMING_MODE</references>
        <references refid="uvfr__global__config_8h_1a0b584a8bce5bc95619d58d126328d24d" compoundref="uvfr__global__config_8h" startline="18">FIRMWARE_MAJOR_RELEASE</references>
        <references refid="uvfr__global__config_8h_1a2ada82deacaaa65d39fd8431202312e8" compoundref="uvfr__global__config_8h" startline="19">FIRMWARE_MINOR_RELEASE</references>
        <references refid="uvfr__global__config_8h_1a056c3375923e87e7b3df830ea10295da" compoundref="uvfr__global__config_8h" startline="20">FIRMWARE_PATCH_NUM</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a302a39661f2460e559645419a2ac8258" compoundref="uvfr__settings_8h" startline="131">FORCE_RESTORE_FACTORY_DEFAULT</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ad99a8ce3d129dcc56d82ee11b0610f18" compoundref="uvfr__settings_8h" startline="120">GENERIC_ACK</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694acc6ddcaa36bd57e5aec12749cb5ce29c" compoundref="uvfr__settings_8h" startline="115">HANDSHAKE</references>
        <references refid="uvfr__settings_8c_1ad566fc47eb8eb3464e5b48f088ddbb83" compoundref="uvfr__settings_8c" startline="84">is_laptop_connected</references>
        <references refid="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" compoundref="uvfr__settings_8c" startline="85">last_contact_with_laptop</references>
        <references refid="structuv___c_a_n__msg_1aae369fbabe3cc5b71a89bb641c24aace" compoundref="uvfr__utils_8h" startline="276">uv_CAN_msg::msg_id</references>
        <references refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4abed5371c079ef927fb67d8bb8e8aa286" compoundref="uvfr__state__engine_8h" startline="84">PROGRAMMING</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a205322c736d66df92b6d968b53648acb" compoundref="uvfr__settings_8h" startline="125">REQUEST_ALL_JOURNAL_ENTRIES</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a9b0e526098fd6c30dc93538edba59405" compoundref="uvfr__settings_8h" startline="124">REQUEST_ALL_SETTINGS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a4313d65a75fd41f3e527b330e7370a5e" compoundref="uvfr__settings_8h" startline="126">REQUEST_JOURNAL_ENTRIES_BY_TIME</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ac53400ee472ace47006a18aaaa4a86a0" compoundref="uvfr__settings_8h" startline="127">REQUEST_SPECIFIC_SETTING</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ad67522ff5c2a93d043e4d26bd905ce34" compoundref="uvfr__settings_8h" startline="117">REQUEST_VCU_STATUS</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a8ad6825ef0a84f2615148dc63202be1f" compoundref="uvfr__settings_8h" startline="128">SAVE_AND_APPLY_NEW_SETTINGS</references>
        <references refid="group__utility__macros_1ga0fa9d4460bcee65d79e048b43dc879fd" compoundref="uvfr__utils_8h" startline="85">serializeSmallE32</references>
        <references refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a7091f0610d47127e952576fcf2d72eac" compoundref="uvfr__settings_8h" startline="122">SET_SPECIFIC_PARAM</references>
        <references refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" compoundref="uvfr__settings_8c" startline="88">settings_queue</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4a9ec1eef180c6208b25b08f0526dc5eb8" compoundref="uvfr__state__engine_8h" startline="83">UV_READY</references>
        <references refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" compoundref="can_8c" startline="513" endline="554">uvSendCanMSG</references>
        <references refid="uvfr__settings_8c_1ad2bb778b8a8907a17c87de89f0eea3c0" compoundref="uvfr__settings_8c" startline="141" endline="143">uvTransmitVehicleStatus</references>
        <references refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" compoundref="uvfr__settings_8c" startline="111">vcu_ack_failed_msg</references>
        <references refid="group__state__engine_1ga2f58cf65b3566bc390600f877f8bed35" compoundref="uvfr__state__engine_8c" startline="47">vehicle_state</references>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status setupDefaultSettings</definition>
        <argsstring>()</argsstring>
        <name>setupDefaultSettings</name>
        <briefdescription>
<para>Function that allocates the neccessary space for all the vehicle settings, and handles sets all of the settings structs to defaults. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="232" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="232" bodyend="255"/>
        <references refid="structuv__vehicle__settings_1a6cdca5b5474080f1dff4d19ef96435e1" compoundref="uvfr__settings_8h" startline="144">uv_vehicle_settings::bms_settings</references>
        <references refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" compoundref="uvfr__settings_8c" startline="20">current_vehicle_settings</references>
        <references refid="structuv__vehicle__settings_1a191aefb9e6f4516a91157e5d6d68205b" compoundref="uvfr__settings_8h" startline="147">uv_vehicle_settings::daq_param_list</references>
        <references refid="structuv__vehicle__settings_1a6caecf0c9fd669e421c4005600d81b71" compoundref="uvfr__settings_8h" startline="146">uv_vehicle_settings::daq_settings</references>
        <references refid="uvfr__settings_8c_1a28e4314b233b9140e73e4fd0bab7e354" compoundref="bms_8c" startline="12">default_bms_settings</references>
        <references refid="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" compoundref="daq_8c" startline="30">default_daq_settings</references>
        <references refid="uvfr__settings_8c_1af5ab2cd7ec858145d49d4e585e4bef94" compoundref="daq_8c" startline="38">default_datapoints</references>
        <references refid="uvfr__settings_8c_1a44daa1a9c68be860616e7bc627d9b8f4" compoundref="driving__loop_8c" startline="27">default_dl_settings</references>
        <references refid="uvfr__settings_8c_1a1071bc1cceac3198de98d9c0753044d6" compoundref="imd_8c" startline="65">default_imd_settings</references>
        <references refid="group__state__engine_1gad9e02be6d2d0bc1ab5cd9fd8cae34230" compoundref="uvfr__state__engine_8c" startline="57">default_os_settings</references>
        <references refid="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" compoundref="uvfr__settings_8c" startline="28">default_pdu_settings</references>
        <references refid="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" compoundref="uvfr__settings_8c" startline="72">default_vehicle</references>
        <references refid="structuv__vehicle__settings_1a7a5207ef389290242764f49c6c48a5ad" compoundref="uvfr__settings_8h" startline="141">uv_vehicle_settings::driving_loop_settings</references>
        <references refid="structuv__vehicle__settings_1ae0c9377c4f8df54ad4b59d4ac4ab39fe" compoundref="uvfr__settings_8h" startline="152">uv_vehicle_settings::flags</references>
        <references refid="structuv__vehicle__settings_1af8dbf93ac51eb9fdc8911644d096486d" compoundref="uvfr__settings_8h" startline="143">uv_vehicle_settings::imd_settings</references>
        <references refid="uvfr__settings_8c_1a1c7fecf890841f27a4ca39fc66e8cc1b" compoundref="motor__controller_8c" startline="14">mc_default_settings</references>
        <references refid="structuv__vehicle__settings_1ad0b0375d2c1674abc6f972eec47e9cb7" compoundref="uvfr__settings_8h" startline="139">uv_vehicle_settings::mc_settings</references>
        <references refid="structuv__vehicle__settings_1adbfed76ceedc0479ff023fea9ba7a84c" compoundref="uvfr__settings_8h" startline="138">uv_vehicle_settings::os_settings</references>
        <references refid="structuv__vehicle__settings_1a01bbfda07b06d31224993ddf9745d285" compoundref="uvfr__settings_8h" startline="149">uv_vehicle_settings::pdu_settings</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="structuv__vehicle__settings_1a6a386c439058f4464e4b82acd1315258" compoundref="uvfr__settings_8h" startline="136">uv_vehicle_settings::veh_info</references>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a4648237563030182a8309d8c75e12205" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void nukeSettings</definition>
        <argsstring>(uv_vehicle_settings **settings_to_delete)</argsstring>
        <name>nukeSettings</name>
        <param>
          <type><ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref> **</type>
          <declname>settings_to_delete</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="260" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="260" bodyend="267"/>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvLoadSettingsFromFlash</definition>
        <argsstring>()</argsstring>
        <name>uvLoadSettingsFromFlash</name>
        <briefdescription>
<para>This loads us some new settings from the flash memory. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="274" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="274" bodyend="299"/>
        <references refid="uvfr__settings_8h_1ab638ad0845e4b5e7007e314c83bc43d5" compoundref="uvfr__settings_8h" startline="60">BMS_ADDR</references>
        <references refid="structuv__vehicle__settings_1a6cdca5b5474080f1dff4d19ef96435e1" compoundref="uvfr__settings_8h" startline="144">uv_vehicle_settings::bms_settings</references>
        <references refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" compoundref="uvfr__settings_8c" startline="20">current_vehicle_settings</references>
        <references refid="uvfr__settings_8h_1aae3049baf8d0bf80753c7b0da5ec8260" compoundref="uvfr__settings_8h" startline="72">DAQ_HEAD_ADDR</references>
        <references refid="structuv__vehicle__settings_1a191aefb9e6f4516a91157e5d6d68205b" compoundref="uvfr__settings_8h" startline="147">uv_vehicle_settings::daq_param_list</references>
        <references refid="uvfr__settings_8h_1ae385496a129924fb290839da5bfa90a2" compoundref="uvfr__settings_8h" startline="76">DAQ_PARAMS1_ADDR</references>
        <references refid="structuv__vehicle__settings_1a6caecf0c9fd669e421c4005600d81b71" compoundref="uvfr__settings_8h" startline="146">uv_vehicle_settings::daq_settings</references>
        <references refid="structuv__vehicle__settings_1a7a5207ef389290242764f49c6c48a5ad" compoundref="uvfr__settings_8h" startline="141">uv_vehicle_settings::driving_loop_settings</references>
        <references refid="uvfr__settings_8h_1aaad501c2b79f55f1bbbae030b6a18dcd" compoundref="uvfr__settings_8h" startline="54">DRIVING_MGROUP</references>
        <references refid="uvfr__settings_8h_1a16f051ea34ee4f4965e4d11f3745d742" compoundref="uvfr__settings_8h" startline="55">DRIVING_OFFSET</references>
        <references refid="uvfr__settings_8h_1aa896deeb35bafb45b994e9c1d0c6500a" compoundref="uvfr__settings_8h" startline="43">GENERAL_VEH_INFO_MGROUP</references>
        <references refid="uvfr__settings_8h_1abcf807ab03bef940a111bb64cfffecfa" compoundref="uvfr__settings_8h" startline="44">GENERAL_VEH_INFO_OFFSET</references>
        <references refid="uvfr__settings_8h_1ae99330d4904337e9a603ad2df6758b95" compoundref="uvfr__settings_8h" startline="64">IMD_ADDR</references>
        <references refid="structuv__vehicle__settings_1af8dbf93ac51eb9fdc8911644d096486d" compoundref="uvfr__settings_8h" startline="143">uv_vehicle_settings::imd_settings</references>
        <references refid="structuv__vehicle__settings_1ad0b0375d2c1674abc6f972eec47e9cb7" compoundref="uvfr__settings_8h" startline="139">uv_vehicle_settings::mc_settings</references>
        <references refid="uvfr__settings_8h_1aad0db57c7f8c7937be54192d7b74bdcf" compoundref="uvfr__settings_8h" startline="50">MOTOR_MGROUP</references>
        <references refid="uvfr__settings_8h_1aa990a9c990001dc29a5ee5fdde3773e4" compoundref="uvfr__settings_8h" startline="51">MOTOR_OFFSET</references>
        <references refid="structuv__vehicle__settings_1adbfed76ceedc0479ff023fea9ba7a84c" compoundref="uvfr__settings_8h" startline="138">uv_vehicle_settings::os_settings</references>
        <references refid="uvfr__settings_8h_1ae727eadb1cf71a3feeb12b7bb2eb83d5" compoundref="uvfr__settings_8h" startline="46">OS_SETTINGS_MGROUP</references>
        <references refid="uvfr__settings_8h_1a012d0d54f18a0eeee83d89f5786db5d5" compoundref="uvfr__settings_8h" startline="47">OS_SETTINGS_OFFSET</references>
        <references refid="uvfr__settings_8h_1aa77056695d9689ca6642d5b7176e33c9" compoundref="uvfr__settings_8h" startline="66">PDU_MGROUP</references>
        <references refid="uvfr__settings_8h_1a8336472ba83c36033d7d4511a2e3b53e" compoundref="uvfr__settings_8h" startline="67">PDU_OFFSET</references>
        <references refid="structuv__vehicle__settings_1a01bbfda07b06d31224993ddf9745d285" compoundref="uvfr__settings_8h" startline="149">uv_vehicle_settings::pdu_settings</references>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="structuv__vehicle__settings_1a6a386c439058f4464e4b82acd1315258" compoundref="uvfr__settings_8h" startline="136">uv_vehicle_settings::veh_info</references>
        <referencedby refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" compoundref="uvfr__settings_8c" startline="334" endline="405">uvSettingsInit</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a086bfc48f5a63b15586c6a2a8a1d29a8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvConfigSettingTask</definition>
        <argsstring>(void *args)</argsstring>
        <name>uvConfigSettingTask</name>
        <param>
          <type>void *</type>
          <declname>args</declname>
        </param>
        <briefdescription>
<para>Function to setup the parameters of the setting setter task. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="305" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="305" bodyend="328"/>
        <references refid="group__state__engine__api_1gga6166ed80f8e3bd62f1e7e6122c8817f6a052e6887345173e8b7556738c28fa920" compoundref="uvfr__state__engine_8h" startline="140">ABOVE_NORMAL</references>
        <references refid="structuv__task__info_1ab24dea3bde4de2d839bf15e65c2df0d6" compoundref="uvfr__state__engine_8h" startline="251">uv_task_info::active_states</references>
        <references refid="structuv__task__info_1a6986d7216c7f889164931b37ab752c29" compoundref="uvfr__state__engine_8h" startline="252">uv_task_info::deletion_states</references>
        <references refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4abed5371c079ef927fb67d8bb8e8aa286" compoundref="uvfr__state__engine_8h" startline="84">PROGRAMMING</references>
        <references refid="structuv__task__info_1a353ec6bf2c42ab0920f3d1e671e568a3" compoundref="uvfr__state__engine_8h" startline="231">uv_task_info::stack_size</references>
        <references refid="structuv__task__info_1aafd4e2d916f50b54b99fd02d63831e43" compoundref="uvfr__state__engine_8h" startline="253">uv_task_info::suspension_states</references>
        <references refid="structuv__task__info_1ae255dff9b38fc8c0754085060e8ae699" compoundref="uvfr__state__engine_8h" startline="243">uv_task_info::task_args</references>
        <references refid="structuv__task__info_1afcd240d2b6b01b4acea600ef4dfe8fbc" compoundref="uvfr__state__engine_8h" startline="227">uv_task_info::task_function</references>
        <references refid="structuv__task__info_1ad24b438130bb3098ee5e855222dff21d" compoundref="uvfr__state__engine_8h" startline="222">uv_task_info::task_name</references>
        <references refid="structuv__task__info_1ad157811debce6672bb6d00da7e90b6ca" compoundref="uvfr__state__engine_8h" startline="224">uv_task_info::task_period</references>
        <references refid="structuv__task__info_1aff45751f7189980589d55379d1d5a355" compoundref="uvfr__state__engine_8h" startline="228">uv_task_info::task_priority</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="group__state__engine__api_1ga99bfc92472cdc99e9005e9d3c792909a" compoundref="uvfr__state__engine_8c" startline="272" endline="310">uvCreateTask</references>
        <references refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</references>
        <referencedby refid="group__state__engine__api_1ga5c608f3832c45eac6e2da198d4ef1ba0" compoundref="uvfr__state__engine_8c" startline="171" endline="193">uvInitStateEngine</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvSettingsInit</definition>
        <argsstring>()</argsstring>
        <name>uvSettingsInit</name>
        <briefdescription>
<para>this function does one thing, and one thing only, it checks if we have custom settings, then it attempts to get them. If it fails, then we revert to factory defaults. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="334" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="334" bodyend="405"/>
        <references refid="uvfr__utils_8h_1a92b5ac44171d49acd084c274385a043a" compoundref="uvfr__utils_8c" startline="296" endline="310">__uvInitPanic</references>
        <references refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" compoundref="uvfr__settings_8c" startline="20">current_vehicle_settings</references>
        <references refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" compoundref="uvfr__settings_8c" startline="152" endline="226">handleIncomingLaptopMsg</references>
        <references refid="group__uvfr__can__api_1ga81adc4a577110ce8fe1158b0dc302cc2" compoundref="can_8c" startline="395" endline="447">insertCANMessageHandler</references>
        <references refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" compoundref="uvfr__settings_8h" startline="90">SETTING_BRANCH_SIZE</references>
        <references refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" compoundref="uvfr__settings_8c" startline="232" endline="255">setupDefaultSettings</references>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" compoundref="uvfr__settings_8c" startline="274" endline="299">uvLoadSettingsFromFlash</references>
        <references refid="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87">uvResetFlashToDefault</references>
        <references refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" compoundref="can_8c" startline="513" endline="554">uvSendCanMSG</references>
        <references refid="uvfr__settings_8c_1a0be2604cded239f54f4f4ab61460a85c" compoundref="uvfr__settings_8c" startline="810" endline="857">uvValidateFlashSettings</references>
        <references refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" compoundref="uvfr__settings_8c" startline="100">vcu_ack_msg</references>
        <referencedby refid="uvfr__utils_8c_1a6d40598f9d8daa89ca159a2e87f4fd01" compoundref="uvfr__utils_8c" startline="46" endline="253">uvInit</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1adfd1bb6988b37f38e799bb1f996ac005" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvUpdateTmpSettings</definition>
        <argsstring>(uint8_t *tmp_settings, uint8_t memgroup, uint8_t m_offset, uint8_t size, uint8_t *data)</argsstring>
        <name>uvUpdateTmpSettings</name>
        <param>
          <type>uint8_t *</type>
          <declname>tmp_settings</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>memgroup</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>m_offset</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>size</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>data</declname>
        </param>
        <briefdescription>
<para>Updates a setting in a temporary SBlock by memory group and offset. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>This indicates that you are attempting to set a setting that bridges the 128 byte &quot;row&quot; system the STM32F40xx uses to organise the flash memory. Attempting to write a parameter like this will result in a busfault.</para>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="411" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="411" bodyend="445"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1aec8886c47c65892251b444760cb30116" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t uvComputeChunkChecksum</definition>
        <argsstring>(uint32_t *chunk)</argsstring>
        <name>uvComputeChunkChecksum</name>
        <param>
          <type>uint32_t *</type>
          <declname>chunk</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="448" column="10" bodyfile="Core/Src/uvfr_settings.c" bodystart="448" bodyend="461"/>
        <references refid="uvfr__settings_8h_1a3a57af5c3275b2f53fa64274b11e8d52" compoundref="uvfr__settings_8h" startline="92">CRC_POLY</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <referencedby refid="uvfr__settings_8c_1a90cba009630be4dc991f7de6cbede4d8" compoundref="uvfr__settings_8c" startline="463" endline="470">uvComputeMemRegionChecksum</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a90cba009630be4dc991f7de6cbede4d8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvComputeMemRegionChecksum</definition>
        <argsstring>(void *sblock, uint32_t *csums, char mregion)</argsstring>
        <name>uvComputeMemRegionChecksum</name>
        <param>
          <type>void *</type>
          <declname>sblock</declname>
        </param>
        <param>
          <type>uint32_t *</type>
          <declname>csums</declname>
        </param>
        <param>
          <type>char</type>
          <declname>mregion</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="463" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="463" bodyend="470"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1aec8886c47c65892251b444760cb30116" compoundref="uvfr__settings_8c" startline="448" endline="461">uvComputeChunkChecksum</references>
        <referencedby refid="uvfr__settings_8c_1aee72930bcdad229cbe8a8adb73e4a3b3" compoundref="uvfr__settings_8c" startline="472" endline="491">uvComputeSettingsChecksums</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1aee72930bcdad229cbe8a8adb73e4a3b3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvComputeSettingsChecksums</definition>
        <argsstring>(void *sblock, uint32_t *csums)</argsstring>
        <name>uvComputeSettingsChecksums</name>
        <param>
          <type>void *</type>
          <declname>sblock</declname>
        </param>
        <param>
          <type>uint32_t *</type>
          <declname>csums</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="472" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="472" bodyend="491"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1a90cba009630be4dc991f7de6cbede4d8" compoundref="uvfr__settings_8c" startline="463" endline="470">uvComputeMemRegionChecksum</references>
        <referencedby refid="uvfr__settings_8c_1a84fc0703372fd83581befabb9fba3858" compoundref="uvfr__settings_8c" startline="495" endline="506">uvValidateChecksums</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a84fc0703372fd83581befabb9fba3858" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvValidateChecksums</definition>
        <argsstring>(void *sblock)</argsstring>
        <name>uvValidateChecksums</name>
        <param>
          <type>void *</type>
          <declname>sblock</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="495" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="495" bodyend="506"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1aee72930bcdad229cbe8a8adb73e4a3b3" compoundref="uvfr__settings_8c" startline="472" endline="491">uvComputeSettingsChecksums</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a2284c8b3e2b6e434f6a1d322396efdb2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void uvSBlockCorruptionHandler</definition>
        <argsstring>()</argsstring>
        <name>uvSBlockCorruptionHandler</name>
        <briefdescription>
<para>Function to call when the Sblock Flash has become corrupted somehow. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="511" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="511" bodyend="552"/>
        <references refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" compoundref="uvfr__settings_8h" startline="37">FLASH_SBLOCK_START</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a36192e27458271ff052029579febb5a1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvOverwriteCsr</definition>
        <argsstring>(void *sblock, uint32_t *csr)</argsstring>
        <name>uvOverwriteCsr</name>
        <param>
          <type>void *</type>
          <declname>sblock</declname>
        </param>
        <param>
          <type>uint32_t *</type>
          <declname>csr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="555" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="555" bodyend="558"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvSaveSettingsToFlash</definition>
        <argsstring>(void *sblock, uint32_t *ecode) PRIVILEGED_FUNCTION</argsstring>
        <name>uvSaveSettingsToFlash</name>
        <param>
          <type>void *</type>
          <declname>sblock</declname>
        </param>
        <param>
          <type>uint32_t *</type>
          <declname>ecode</declname>
        </param>
        <briefdescription>
<para>Function to save a finished settings block to flash memory. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="574" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="574" bodyend="710"/>
        <references refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" compoundref="uvfr__settings_8c" startline="567">DATA_MISMATCH</references>
        <references refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" compoundref="uvfr__settings_8c" startline="566">DID_NOT_FINISH_PROGRAMMING</references>
        <references refid="uvfr__global__config_8h_1a0b584a8bce5bc95619d58d126328d24d" compoundref="uvfr__global__config_8h" startline="18">FIRMWARE_MAJOR_RELEASE</references>
        <references refid="uvfr__global__config_8h_1a2ada82deacaaa65d39fd8431202312e8" compoundref="uvfr__global__config_8h" startline="19">FIRMWARE_MINOR_RELEASE</references>
        <references refid="uvfr__global__config_8h_1a056c3375923e87e7b3df830ea10295da" compoundref="uvfr__global__config_8h" startline="20">FIRMWARE_PATCH_NUM</references>
        <references refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" compoundref="uvfr__settings_8c" startline="565">FLASH_NOT_UNLOCKED</references>
        <references refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" compoundref="uvfr__settings_8h" startline="37">FLASH_SBLOCK_START</references>
        <references refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" compoundref="uvfr__settings_8c" startline="564">INVALID_SBLOCK</references>
        <references refid="uvfr__settings_8h_1a54061e5993a5517320d425f44408cc86" compoundref="uvfr__settings_8h" startline="96">MAGIC_NUMBER</references>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__settings_8h_1aa81180ef8eb37ec6e7d99d706610680d" compoundref="uvfr__settings_8h" startline="27">TOP_OF_FLASH_SBLOCK</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <referencedby refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" compoundref="uvfr__settings_8c" startline="1057" endline="1138">uvResetFlashToDefault</referencedby>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a30c09e445d8f0fbfbdfd1bfa0fcfdc67" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvSetSettingResponseReminder</definition>
        <argsstring>(uint32_t reminder)</argsstring>
        <name>uvSetSettingResponseReminder</name>
        <param>
          <type>uint32_t</type>
          <declname>reminder</declname>
        </param>
        <briefdescription>
<para>This reminds the VCU to shoot off it&apos;s own message later when it reboots. </para>
        </briefdescription>
        <detaileddescription>
<para>@deperecated </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="716" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="716" bodyend="728"/>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a8e128ab49bfb636a4597802418066784" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvForceDefaultReversionUponDeviceReset</definition>
        <argsstring>()</argsstring>
        <name>uvForceDefaultReversionUponDeviceReset</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><xrefsect id="deprecated_1_deprecated000004"><xreftitle>Deprecated</xreftitle><xrefdescription></xrefdescription></xrefsect></para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="735" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="735" bodyend="749"/>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a53df36781d38254cb6bbe6717e6ebae0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void *</type>
        <definition>void* uvCreateTmpSettingsCopy</definition>
        <argsstring>()</argsstring>
        <name>uvCreateTmpSettingsCopy</name>
        <briefdescription>
<para>Function that creates a temporary copy of the existing settings. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="756" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="756" bodyend="772"/>
        <references refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" compoundref="uvfr__settings_8h" startline="90">SETTING_BRANCH_SIZE</references>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvSendSpecificParam</definition>
        <argsstring>(uint8_t *origin, uint8_t mgroup, uint8_t m_offset, uint8_t size)</argsstring>
        <name>uvSendSpecificParam</name>
        <param>
          <type>uint8_t *</type>
          <declname>origin</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>mgroup</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>m_offset</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
<para>Function that locates a specific setting parameter and sends the value over canbus. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="778" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="778" bodyend="797"/>
        <references refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" compoundref="uvfr__utils_8h" startline="277">uv_CAN_msg::data</references>
        <references refid="structuv___c_a_n__msg_1aa74af3745c8b56910d7c309245541d37" compoundref="uvfr__utils_8h" startline="275">uv_CAN_msg::dlc</references>
        <references refid="structuv___c_a_n__msg_1a3a3fdc7fed06a631fefa58ea44052d8d" compoundref="uvfr__utils_8h" startline="271">uv_CAN_msg::flags</references>
        <references refid="structuv___c_a_n__msg_1aae369fbabe3cc5b71a89bb641c24aace" compoundref="uvfr__utils_8h" startline="276">uv_CAN_msg::msg_id</references>
        <references refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" compoundref="uvfr__settings_8h" startline="25">START_OF_USER_FLASH</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" compoundref="can_8c" startline="513" endline="554">uvSendCanMSG</references>
        <referencedby refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" compoundref="uvfr__settings_8c" startline="1143" endline="1158">uvSendSettingGroup</referencedby>
        <referencedby refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" compoundref="uvfr__settings_8c" startline="864" endline="1052">uvSettingsProgrammerTask</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvResetFlashToDefault</definition>
        <argsstring>(void *new_sblock)</argsstring>
        <name>uvResetFlashToDefault</name>
        <param>
          <type>void *</type>
          <declname>new_sblock</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
<para>uvSendCanMSG(&amp;vcu_ack_msg);</para>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="1057" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="1057" bodyend="1138"/>
        <references refid="uvfr__settings_8h_1a25a35d43902b9bec03daae2ef17883b1" compoundref="uvfr__settings_8h" startline="58">BMS_MGROUP</references>
        <references refid="uvfr__settings_8h_1a95973d7f17e9a5994743b16520f6a136" compoundref="uvfr__settings_8h" startline="59">BMS_OFFSET</references>
        <references refid="uvfr__settings_8h_1a14f988f2e948d8f522f0ef04a29762d6" compoundref="uvfr__settings_8h" startline="70">DAQ_HEAD_MGROUP</references>
        <references refid="uvfr__settings_8h_1afc36afa04b73fc9a1ea92b22e6cb564f" compoundref="uvfr__settings_8h" startline="71">DAQ_HEAD_OFFSET</references>
        <references refid="uvfr__settings_8h_1a084bd6444fb9817cc88531b879ba571b" compoundref="uvfr__settings_8h" startline="74">DAQ_PARAMS1_MGROUP</references>
        <references refid="uvfr__settings_8h_1a10d6e75bc6bdeb4dec495cbfe05682fd" compoundref="uvfr__settings_8h" startline="75">DAQ_PARAMS1_OFFSET</references>
        <references refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" compoundref="uvfr__settings_8c" startline="567">DATA_MISMATCH</references>
        <references refid="uvfr__settings_8c_1a28e4314b233b9140e73e4fd0bab7e354" compoundref="bms_8c" startline="12">default_bms_settings</references>
        <references refid="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" compoundref="daq_8c" startline="30">default_daq_settings</references>
        <references refid="uvfr__settings_8c_1af5ab2cd7ec858145d49d4e585e4bef94" compoundref="daq_8c" startline="38">default_datapoints</references>
        <references refid="uvfr__settings_8c_1a44daa1a9c68be860616e7bc627d9b8f4" compoundref="driving__loop_8c" startline="27">default_dl_settings</references>
        <references refid="uvfr__settings_8c_1a1071bc1cceac3198de98d9c0753044d6" compoundref="imd_8c" startline="65">default_imd_settings</references>
        <references refid="group__state__engine_1gad9e02be6d2d0bc1ab5cd9fd8cae34230" compoundref="uvfr__state__engine_8c" startline="57">default_os_settings</references>
        <references refid="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" compoundref="uvfr__settings_8c" startline="28">default_pdu_settings</references>
        <references refid="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" compoundref="uvfr__settings_8c" startline="72">default_vehicle</references>
        <references refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" compoundref="uvfr__settings_8c" startline="566">DID_NOT_FINISH_PROGRAMMING</references>
        <references refid="uvfr__settings_8h_1aaad501c2b79f55f1bbbae030b6a18dcd" compoundref="uvfr__settings_8h" startline="54">DRIVING_MGROUP</references>
        <references refid="uvfr__settings_8h_1a16f051ea34ee4f4965e4d11f3745d742" compoundref="uvfr__settings_8h" startline="55">DRIVING_OFFSET</references>
        <references refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" compoundref="uvfr__settings_8c" startline="565">FLASH_NOT_UNLOCKED</references>
        <references refid="uvfr__settings_8h_1abcf807ab03bef940a111bb64cfffecfa" compoundref="uvfr__settings_8h" startline="44">GENERAL_VEH_INFO_OFFSET</references>
        <references refid="uvfr__settings_8h_1ae5fe9f0cb3fad913bd688758c9b24d79" compoundref="uvfr__settings_8h" startline="62">IMD_MGROUP</references>
        <references refid="uvfr__settings_8h_1a790b81866b0c7880d2d8fcb39880885a" compoundref="uvfr__settings_8h" startline="63">IMD_OFFSET</references>
        <references refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" compoundref="uvfr__settings_8c" startline="564">INVALID_SBLOCK</references>
        <references refid="uvfr__settings_8h_1a54061e5993a5517320d425f44408cc86" compoundref="uvfr__settings_8h" startline="96">MAGIC_NUMBER</references>
        <references refid="uvfr__settings_8c_1a1c7fecf890841f27a4ca39fc66e8cc1b" compoundref="motor__controller_8c" startline="14">mc_default_settings</references>
        <references refid="uvfr__settings_8h_1aad0db57c7f8c7937be54192d7b74bdcf" compoundref="uvfr__settings_8h" startline="50">MOTOR_MGROUP</references>
        <references refid="uvfr__settings_8h_1aa990a9c990001dc29a5ee5fdde3773e4" compoundref="uvfr__settings_8h" startline="51">MOTOR_OFFSET</references>
        <references refid="uvfr__settings_8h_1a012d0d54f18a0eeee83d89f5786db5d5" compoundref="uvfr__settings_8h" startline="47">OS_SETTINGS_OFFSET</references>
        <references refid="uvfr__settings_8h_1aa77056695d9689ca6642d5b7176e33c9" compoundref="uvfr__settings_8h" startline="66">PDU_MGROUP</references>
        <references refid="uvfr__settings_8h_1a8336472ba83c36033d7d4511a2e3b53e" compoundref="uvfr__settings_8h" startline="67">PDU_OFFSET</references>
        <references refid="uvfr__settings_8c_1a1e63b2fed237e9d016b304884c01457b" compoundref="uvfr__settings_8c" startline="569">POST_CHECKSUM</references>
        <references refid="uvfr__settings_8c_1a4fc65d72946e3e169f15ed0015fa3d3c" compoundref="uvfr__settings_8c" startline="568">PRE_CHECKSUM</references>
        <references refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" compoundref="uvfr__settings_8h" startline="90">SETTING_BRANCH_SIZE</references>
        <references refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" compoundref="uvfr__settings_8c" startline="128" endline="136">settingCopy</references>
        <references refid="structdaq__loop__args_1acb7bf20ade7a6544c747aebc165b7faf" compoundref="daq_8h" startline="87">daq_loop_args::total_params_logged</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" compoundref="uvfr__settings_8c" startline="574" endline="710">uvSaveSettingsToFlash</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref></type>
        <definition>uv_status uvSendSettingGroup</definition>
        <argsstring>(uint8_t *origin, uint8_t memgroup, uint8_t m_offset, uint16_t size)</argsstring>
        <name>uvSendSettingGroup</name>
        <param>
          <type>uint8_t *</type>
          <declname>origin</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>memgroup</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>m_offset</declname>
        </param>
        <param>
          <type>uint16_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
<para>Helper function for sending all settings. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="1143" column="11" bodyfile="Core/Src/uvfr_settings.c" bodystart="1143" bodyend="1158"/>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" compoundref="uvfr__utils_8h" startline="169">UV_ERROR</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" compoundref="uvfr__settings_8c" startline="778" endline="797">uvSendSpecificParam</references>
        <referencedby refid="uvfr__settings_8c_1a4610dbfba4a1c427386d906bfc656b77" compoundref="uvfr__settings_8c" startline="1163" endline="1220">sendAllSettingsWorker</referencedby>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a4610dbfba4a1c427386d906bfc656b77" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void sendAllSettingsWorker</definition>
        <argsstring>(void *args)</argsstring>
        <name>sendAllSettingsWorker</name>
        <param>
          <type>void *</type>
          <declname>args</declname>
        </param>
        <briefdescription>
<para>Sub-task that sends all settings from the VCU to the. </para>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="1163" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="1163" bodyend="1220"/>
        <references refid="structsetting__helper__task_1a2db368e63a9cc11c26caa2a0eacfca45" compoundref="uvfr__settings_8c" startline="65">setting_helper_task::args</references>
        <references refid="uvfr__settings_8h_1a25a35d43902b9bec03daae2ef17883b1" compoundref="uvfr__settings_8h" startline="58">BMS_MGROUP</references>
        <references refid="uvfr__settings_8h_1a95973d7f17e9a5994743b16520f6a136" compoundref="uvfr__settings_8h" startline="59">BMS_OFFSET</references>
        <references refid="uvfr__settings_8c_1af0cbf7f4ea57695f3b1d2d3c83844000" compoundref="uvfr__settings_8c" startline="93">child_task_active</references>
        <references refid="uvfr__settings_8c_1a19de39f55cc05851f5fa6a40070681e3" compoundref="uvfr__settings_8c" startline="92">child_task_handle</references>
        <references refid="uvfr__settings_8h_1a14f988f2e948d8f522f0ef04a29762d6" compoundref="uvfr__settings_8h" startline="70">DAQ_HEAD_MGROUP</references>
        <references refid="uvfr__settings_8h_1afc36afa04b73fc9a1ea92b22e6cb564f" compoundref="uvfr__settings_8h" startline="71">DAQ_HEAD_OFFSET</references>
        <references refid="uvfr__settings_8h_1a084bd6444fb9817cc88531b879ba571b" compoundref="uvfr__settings_8h" startline="74">DAQ_PARAMS1_MGROUP</references>
        <references refid="uvfr__settings_8h_1a10d6e75bc6bdeb4dec495cbfe05682fd" compoundref="uvfr__settings_8h" startline="75">DAQ_PARAMS1_OFFSET</references>
        <references refid="uvfr__settings_8h_1aaad501c2b79f55f1bbbae030b6a18dcd" compoundref="uvfr__settings_8h" startline="54">DRIVING_MGROUP</references>
        <references refid="uvfr__settings_8h_1a16f051ea34ee4f4965e4d11f3745d742" compoundref="uvfr__settings_8h" startline="55">DRIVING_OFFSET</references>
        <references refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" compoundref="uvfr__settings_8h" startline="37">FLASH_SBLOCK_START</references>
        <references refid="uvfr__settings_8h_1aa896deeb35bafb45b994e9c1d0c6500a" compoundref="uvfr__settings_8h" startline="43">GENERAL_VEH_INFO_MGROUP</references>
        <references refid="uvfr__settings_8h_1abcf807ab03bef940a111bb64cfffecfa" compoundref="uvfr__settings_8h" startline="44">GENERAL_VEH_INFO_OFFSET</references>
        <references refid="uvfr__settings_8h_1ae5fe9f0cb3fad913bd688758c9b24d79" compoundref="uvfr__settings_8h" startline="62">IMD_MGROUP</references>
        <references refid="uvfr__settings_8h_1a790b81866b0c7880d2d8fcb39880885a" compoundref="uvfr__settings_8h" startline="63">IMD_OFFSET</references>
        <references refid="structsetting__helper__task_1a867ac831a9ae5bbfb2ee7b32d63e8916" compoundref="uvfr__settings_8c" startline="60">setting_helper_task::meta_task_handle</references>
        <references refid="uvfr__settings_8h_1aad0db57c7f8c7937be54192d7b74bdcf" compoundref="uvfr__settings_8h" startline="50">MOTOR_MGROUP</references>
        <references refid="uvfr__settings_8h_1aa990a9c990001dc29a5ee5fdde3773e4" compoundref="uvfr__settings_8h" startline="51">MOTOR_OFFSET</references>
        <references refid="uvfr__settings_8h_1ae727eadb1cf71a3feeb12b7bb2eb83d5" compoundref="uvfr__settings_8h" startline="46">OS_SETTINGS_MGROUP</references>
        <references refid="uvfr__settings_8h_1a012d0d54f18a0eeee83d89f5786db5d5" compoundref="uvfr__settings_8h" startline="47">OS_SETTINGS_OFFSET</references>
        <references refid="uvfr__settings_8h_1aa77056695d9689ca6642d5b7176e33c9" compoundref="uvfr__settings_8h" startline="66">PDU_MGROUP</references>
        <references refid="uvfr__settings_8h_1a8336472ba83c36033d7d4511a2e3b53e" compoundref="uvfr__settings_8h" startline="67">PDU_OFFSET</references>
        <references refid="structtx__all__settings__args_1a8e42222b51c2f152869fc760560442b0" compoundref="uvfr__settings_8c" startline="36">tx_all_settings_args::sblock_origin</references>
        <references refid="unionhelper__task__args_1a083dff2889a9c9006875745783ed5f45" compoundref="uvfr__settings_8c" startline="52">helper_task_args::setting_tx_args</references>
        <references refid="structsetting__helper__task_1a7446a818ec9497a6b93a7995bf8b66d3" compoundref="uvfr__settings_8c" startline="62">setting_helper_task::status</references>
        <references refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" compoundref="uvfr__utils_8h" startline="167">UV_OK</references>
        <references refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" compoundref="uvfr__settings_8c" startline="1143" endline="1158">uvSendSettingGroup</references>
      </memberdef>
      <memberdef kind="function" id="uvfr__settings_8c_1a632dfb21b35fd170c003515ef4bdc291" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void sendJournalWorker</definition>
        <argsstring>(void *args)</argsstring>
        <name>sendJournalWorker</name>
        <param>
          <type>void *</type>
          <declname>args</declname>
        </param>
        <briefdescription>
<para>Sub-task that reads out the journal. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="attention"><para>EVENT LOGGING IS NOT IMPLEMENTED YET, DO NOT TOUCH THIS </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="Core/Src/uvfr_settings.c" line="1226" column="6" bodyfile="Core/Src/uvfr_settings.c" bodystart="1226" bodyend="1228"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>uvfr_settings.c</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/><sp/>Created<sp/>on:<sp/>Oct<sp/>10,<sp/>2024</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>Author:<sp/>byo10</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7" refid="uvfr__settings_8c_1a7350f4a84cab7a08d99c9e88b248a180" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SRC_UVFR_SETTINGS_C_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="uvfr__utils_8h" kindref="compound">uvfr_utils.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="main_8h" kindref="compound">main.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;stdlib.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13" refid="uvfr__settings_8c_1a9320db4d0509341600bb7584ca595609" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>VCU_TO_LAPTOP_ID<sp/>0x420</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14" refid="uvfr__settings_8c_1aaa6ee3d8e77c95b379e21d4b827ad783" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LAPTOP_TO_VCU_ID<sp/>0x520</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>PRIVILEGED_DATA<sp/>uint8_t<sp/><ref refid="uvfr__settings_8c_1a7c9185b38cc68d3a0c2c205746d25494" kindref="member">_s_uvdata</ref>;<sp/></highlight><highlight class="comment">//Start<sp/>and<sp/>end<sp/>of<sp/>user<sp/>flash<sp/>symbols</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>PRIVILEGED_DATA<sp/>uint8_t<sp/><ref refid="uvfr__settings_8c_1a32dcb66c3240af325158ccd12dcb3c68" kindref="member">_e_uvdata</ref>;</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">//global<sp/>variables<sp/>for<sp/>all<sp/>to<sp/>enjoy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" refkind="member"><highlight class="normal"><ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref>*<sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref><sp/><ref refid="group__state__engine_1gad9e02be6d2d0bc1ab5cd9fd8cae34230" kindref="member">default_os_settings</ref>;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref><sp/><ref refid="uvfr__settings_8c_1a1c7fecf890841f27a4ca39fc66e8cc1b" kindref="member">mc_default_settings</ref>;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdriving__loop__args" kindref="compound">driving_loop_args</ref><sp/><ref refid="uvfr__settings_8c_1a44daa1a9c68be860616e7bc627d9b8f4" kindref="member">default_dl_settings</ref>;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref><sp/><ref refid="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" kindref="member">default_daq_settings</ref>;</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref><sp/><ref refid="uvfr__settings_8c_1a1071bc1cceac3198de98d9c0753044d6" kindref="member">default_imd_settings</ref>;</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="structbms__settings__t" kindref="compound">bms_settings_t</ref><sp/><ref refid="uvfr__settings_8c_1a28e4314b233b9140e73e4fd0bab7e354" kindref="member">default_bms_settings</ref>;</highlight></codeline>
<codeline lineno="28" refid="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" refkind="member"><highlight class="normal"><ref refid="structuv19__pdu__settings" kindref="compound">uv19_pdu_settings</ref><sp/><ref refid="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" kindref="member">default_pdu_settings</ref>;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="structdaq__datapoint" kindref="compound">daq_datapoint</ref><sp/><ref refid="uvfr__settings_8c_1af5ab2cd7ec858145d49d4e585e4bef94" kindref="member">default_datapoints</ref>[];</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="35" refid="structtx__all__settings__args" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structtx__all__settings__args" kindref="compound">tx_all_settings_args</ref>{</highlight></codeline>
<codeline lineno="36" refid="structtx__all__settings__args_1a8e42222b51c2f152869fc760560442b0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t*<sp/><ref refid="structtx__all__settings__args_1a8e42222b51c2f152869fc760560442b0" kindref="member">sblock_origin</ref>;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal">}<ref refid="uvfr__settings_8c_1a0641c122dc09626011ee339625d1ea63" kindref="member">tx_all_settings_args</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="43" refid="structtx__journal__args" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structtx__journal__args" kindref="compound">tx_journal_args</ref>{</highlight></codeline>
<codeline lineno="44" refid="structtx__journal__args_1a47ca8e1495cb07e794ea926dedff2da7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="structtx__journal__args_1a47ca8e1495cb07e794ea926dedff2da7" kindref="member">start_time</ref>;</highlight></codeline>
<codeline lineno="45" refid="structtx__journal__args_1a170540474cdd1a431f8e257d5a70c4ac" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="structtx__journal__args_1a170540474cdd1a431f8e257d5a70c4ac" kindref="member">end_time</ref>;</highlight></codeline>
<codeline lineno="46"><highlight class="normal">}<ref refid="uvfr__settings_8c_1a9a7490c87797ddce618071ea477c8009" kindref="member">tx_journal_args</ref>;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="51" refid="unionhelper__task__args" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">union<sp/></highlight><highlight class="normal"><ref refid="unionhelper__task__args" kindref="compound">helper_task_args</ref>{</highlight></codeline>
<codeline lineno="52" refid="unionhelper__task__args_1a083dff2889a9c9006875745783ed5f45" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structtx__all__settings__args" kindref="compound">tx_all_settings_args</ref><sp/><ref refid="unionhelper__task__args_1a083dff2889a9c9006875745783ed5f45" kindref="member">setting_tx_args</ref>;</highlight></codeline>
<codeline lineno="53" refid="unionhelper__task__args_1a530fb24214eb4c3733920bf4446eb571" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structtx__journal__args" kindref="compound">tx_journal_args</ref><sp/><ref refid="unionhelper__task__args_1a530fb24214eb4c3733920bf4446eb571" kindref="member">journal_tx_args</ref>;</highlight></codeline>
<codeline lineno="54"><highlight class="normal">}<ref refid="uvfr__settings_8c_1a06b8e5486501c8fe34e2a1c669e4a01c" kindref="member">helper_task_args</ref>;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="59" refid="structsetting__helper__task" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structsetting__helper__task" kindref="compound">setting_helper_task</ref>{</highlight></codeline>
<codeline lineno="60" refid="structsetting__helper__task_1a867ac831a9ae5bbfb2ee7b32d63e8916" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>TaskHandle_t<sp/><ref refid="structsetting__helper__task_1a867ac831a9ae5bbfb2ee7b32d63e8916" kindref="member">meta_task_handle</ref>;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62" refid="structsetting__helper__task_1a7446a818ec9497a6b93a7995bf8b66d3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="structsetting__helper__task_1a7446a818ec9497a6b93a7995bf8b66d3" kindref="member">status</ref>;</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="structsetting__helper__task_1a2db368e63a9cc11c26caa2a0eacfca45" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="unionhelper__task__args" kindref="compound">helper_task_args</ref><sp/><ref refid="structsetting__helper__task_1a2db368e63a9cc11c26caa2a0eacfca45" kindref="member">args</ref>;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal">}<ref refid="uvfr__settings_8c_1aff5e0078d7c880f42cc79e084141a6bd" kindref="member">setting_helper_task</ref>;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="72" refid="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" refkind="member"><highlight class="normal"><ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref><sp/><ref refid="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" kindref="member">default_vehicle</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>.<ref refid="structveh__gen__info_1a4561037fdc0d97cbdac2c5a92a7dd241" kindref="member">wheel_size</ref><sp/>=<sp/>0xEEEEEEEE,</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/>.drive_ratio<sp/>=<sp/>0xDDDDDDDD,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>.test1<sp/>=<sp/>0xCCCC,</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>.test2<sp/>=<sp/>0xBBBB,</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>.test3<sp/>=<sp/>0xAAAA,</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>.test4<sp/>=<sp/>0x99,</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>.test5<sp/>=<sp/>0x88,</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>.test6<sp/>=<sp/>0x77777777</highlight></codeline>
<codeline lineno="81"><highlight class="normal">};</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">//Status<sp/>of<sp/>laptop<sp/>connection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="uvfr__settings_8c_1ad566fc47eb8eb3464e5b48f088ddbb83" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1ad566fc47eb8eb3464e5b48f088ddbb83" kindref="member">is_laptop_connected</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="85" refid="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" refkind="member"><highlight class="normal">TickType_t<sp/><ref refid="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" kindref="member">last_contact_with_laptop</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="comment">//Queue<sp/>for<sp/>messages<sp/>coming<sp/>to<sp/>the<sp/>setting<sp/>setter<sp/>program</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>QueueHandle_t<sp/><ref refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" kindref="member">settings_queue</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90" refid="uvfr__settings_8c_1a6726b669a3c5795c3326238ab974f382" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>TaskHandle_t<sp/><ref refid="uvfr__settings_8c_1a6726b669a3c5795c3326238ab974f382" kindref="member">ptask_handle</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92" refid="uvfr__settings_8c_1a19de39f55cc05851f5fa6a40070681e3" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>TaskHandle_t<sp/><ref refid="uvfr__settings_8c_1a19de39f55cc05851f5fa6a40070681e3" kindref="member">child_task_handle</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="93" refid="uvfr__settings_8c_1af0cbf7f4ea57695f3b1d2d3c83844000" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1af0cbf7f4ea57695f3b1d2d3c83844000" kindref="member">child_task_active</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight></codeline>
<codeline lineno="100" refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" refkind="member"><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref><sp/><ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>.<ref refid="structuv___c_a_n__msg_1a3a3fdc7fed06a631fefa58ea44052d8d" kindref="member">flags</ref><sp/>=<sp/>0x00,</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>.dlc<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>.data<sp/>=<sp/>{0x10,0,0,0,0,0,0,0},</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>.msg_id<sp/>=<sp/><ref refid="uvfr__settings_8c_1a9320db4d0509341600bb7584ca595609" kindref="member">VCU_TO_LAPTOP_ID</ref></highlight></codeline>
<codeline lineno="105"><highlight class="normal">};</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" refkind="member"><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref><sp/><ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>.<ref refid="structuv___c_a_n__msg_1a3a3fdc7fed06a631fefa58ea44052d8d" kindref="member">flags</ref><sp/>=<sp/>0x00,</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>.dlc<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>.data<sp/>=<sp/>{0x11,0,0,0,0,0,0,0},</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>.msg_id<sp/>=<sp/><ref refid="uvfr__settings_8c_1a9320db4d0509341600bb7584ca595609" kindref="member">VCU_TO_LAPTOP_ID</ref></highlight></codeline>
<codeline lineno="116"><highlight class="normal">};</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a0be2604cded239f54f4f4ab61460a85c" kindref="member">uvValidateFlashSettings</ref>();</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87" kindref="member">uvResetFlashToDefault</ref>();</highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" kindref="member">uvSettingsProgrammerTask</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="128" refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" refkind="member"><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>(uint8_t*<sp/>from,<sp/>uint8_t*<sp/>to,<sp/>uint16_t<sp/>length)<sp/>PRIVILEGED_FUNCTION{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(from<sp/>==<sp/>NULL<sp/>||<sp/>to<sp/>==<sp/>NULL<sp/>||<sp/>length<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//No<sp/>null<sp/>errors<sp/>on<sp/>my<sp/>watch<sp/>buddy<sp/>boy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;length;<sp/>i++){</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(to<sp/>+<sp/>i)<sp/>=<sp/>*(from<sp/>+<sp/>i);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="136"><highlight class="normal">}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="141" refid="uvfr__settings_8c_1ad2bb778b8a8907a17c87de89f0eea3c0" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1ad2bb778b8a8907a17c87de89f0eea3c0" kindref="member">uvTransmitVehicleStatus</ref>(){</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="143"><highlight class="normal">}</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145" refid="uvfr__settings_8c_1a66126a25eee9ffcb3c5fa49314fc998b" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a66126a25eee9ffcb3c5fa49314fc998b" kindref="member">uvAwaitLaptopAckMsg</ref>(){</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea6aa86f67f1dcd70789b27731c3ac4e7a" kindref="member">UV_ABORTED</ref>;</highlight></codeline>
<codeline lineno="147"><highlight class="normal">}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="152" refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" kindref="member">handleIncomingLaptopMsg</ref>(<ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref>*<sp/>msg)<sp/>PRIVILEGED_FUNCTION{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>cmd_byte<sp/>=<sp/>msg-&gt;data[0];</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref><sp/>blank_msg<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.<ref refid="structuv___c_a_n__msg_1aae369fbabe3cc5b71a89bb641c24aace" kindref="member">msg_id</ref><sp/>=<sp/>0x420,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.flags<sp/>=<sp/>0x00,</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.dlc<sp/>=<sp/>8</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" kindref="member">last_contact_with_laptop</ref><sp/>=<sp/>xTaskGetTickCount();</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(cmd_byte){</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694acc6ddcaa36bd57e5aec12749cb5ce29c" kindref="member">HANDSHAKE</ref>:</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1ad566fc47eb8eb3464e5b48f088ddbb83" kindref="member">is_laptop_connected</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" kindref="member">last_contact_with_laptop</ref><sp/>=<sp/>xTaskGetTickCount();</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aa74af3745c8b56910d7c309245541d37" kindref="member">dlc</ref><sp/>=<sp/>8;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[0]<sp/>=<sp/>0x01;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__utility__macros_1ga0fa9d4460bcee65d79e048b43dc879fd" kindref="member">serializeSmallE32</ref>(blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>,<ref refid="uvfr__settings_8c_1a4a1aa886008fc488d72c502d5af2aa52" kindref="member">last_contact_with_laptop</ref>,1);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[5]<sp/>=<sp/><ref refid="uvfr__global__config_8h_1a0b584a8bce5bc95619d58d126328d24d" kindref="member">FIRMWARE_MAJOR_RELEASE</ref>;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[6]<sp/>=<sp/><ref refid="uvfr__global__config_8h_1a2ada82deacaaa65d39fd8431202312e8" kindref="member">FIRMWARE_MINOR_RELEASE</ref>;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[7]<sp/>=<sp/><ref refid="uvfr__global__config_8h_1a056c3375923e87e7b3df830ea10295da" kindref="member">FIRMWARE_PATCH_NUM</ref>;</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;blank_msg);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694aab474c9db56509a37ee4ee2930849b38" kindref="member">ENTER_PROGRAMMING_MODE</ref>:</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__state__engine_1ga2f58cf65b3566bc390600f877f8bed35" kindref="member">vehicle_state</ref><sp/>==<sp/><ref refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4a9ec1eef180c6208b25b08f0526dc5eb8" kindref="member">UV_READY</ref>){</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Relevant<sp/>Ack.<sp/>frame<sp/>sent<sp/>upon<sp/>succesful<sp/>startup<sp/>of<sp/>programmer<sp/>task</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__state__engine__api_1gaa3ad3e8df75177c00265881c16563212" kindref="member">changeVehicleState</ref>(<ref refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4abed5371c079ef927fb67d8bb8e8aa286" kindref="member">PROGRAMMING</ref>);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//should<sp/>not<sp/>be<sp/>programming<sp/>if<sp/>in<sp/>either<sp/>of<sp/>these<sp/>states</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ad67522ff5c2a93d043e4d26bd905ce34" kindref="member">REQUEST_VCU_STATUS</ref>:</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO<sp/>Respond<sp/>with<sp/>VCU<sp/>status</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1ad2bb778b8a8907a17c87de89f0eea3c0" kindref="member">uvTransmitVehicleStatus</ref>()!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ad99a8ce3d129dcc56d82ee11b0610f18" kindref="member">GENERIC_ACK</ref>:</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Could<sp/>come<sp/>at<sp/>any<sp/>time,<sp/>however<sp/>here<sp/>we<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a7091f0610d47127e952576fcf2d72eac" kindref="member">SET_SPECIFIC_PARAM</ref><sp/>...<sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694aefd2ddc079bf62b63b3e5226b9a83ac3" kindref="member">END_OF_SPECIFIC_PARAMS</ref>:</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ab8a24171d3940ec1ea3160842c3e4b4b" kindref="member">CLEAR_FAULTS</ref>:</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a9b0e526098fd6c30dc93538edba59405" kindref="member">REQUEST_ALL_SETTINGS</ref>:</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a205322c736d66df92b6d968b53648acb" kindref="member">REQUEST_ALL_JOURNAL_ENTRIES</ref>:</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a4313d65a75fd41f3e527b330e7370a5e" kindref="member">REQUEST_JOURNAL_ENTRIES_BY_TIME</ref>:</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ac53400ee472ace47006a18aaaa4a86a0" kindref="member">REQUEST_SPECIFIC_SETTING</ref>:</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a8ad6825ef0a84f2615148dc63202be1f" kindref="member">SAVE_AND_APPLY_NEW_SETTINGS</ref>:</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a485f41f6d806239622abbac7aef60557" kindref="member">DISCARD_NEW_SETTINGS</ref>:</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694abe34f5f2d055215f2ff2e2d85401199a" kindref="member">DISCARD_NEW_SETTINGS_AND_EXIT</ref>:</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a302a39661f2460e559645419a2ac8258" kindref="member">FORCE_RESTORE_FACTORY_DEFAULT</ref>:</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//We<sp/>need<sp/>to<sp/>be<sp/>in<sp/>programming<sp/>mode<sp/>for<sp/>these.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__state__engine_1ga2f58cf65b3566bc390600f877f8bed35" kindref="member">vehicle_state</ref><sp/>==<sp/><ref refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4abed5371c079ef927fb67d8bb8e8aa286" kindref="member">PROGRAMMING</ref>){</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" kindref="member">settings_queue</ref><sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(xQueueSend(<ref refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" kindref="member">settings_queue</ref>,msg,0)<sp/>!=<sp/>pdTRUE){</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvPanic(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,0);</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//send<sp/>negative<sp/>ACK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//otherwise<sp/>we<sp/>will<sp/>ignore</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//cmd_byte<sp/>we<sp/>do<sp/>not<sp/>recognise.<sp/>We<sp/>assme<sp/>the<sp/>laptop<sp/>is<sp/>geeked,<sp/>and<sp/>move<sp/>on</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal">}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="232" refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" kindref="member">setupDefaultSettings</ref>(){</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvFree(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//real<sp/>trap<sp/>shit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>=<sp/>uvMalloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref>));</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a6a386c439058f4464e4b82acd1315258" kindref="member">veh_info</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" kindref="member">default_vehicle</ref>;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1adbfed76ceedc0479ff023fea9ba7a84c" kindref="member">os_settings</ref><sp/>=<sp/>&amp;<ref refid="group__state__engine_1gad9e02be6d2d0bc1ab5cd9fd8cae34230" kindref="member">default_os_settings</ref>;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1ad0b0375d2c1674abc6f972eec47e9cb7" kindref="member">mc_settings</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1a1c7fecf890841f27a4ca39fc66e8cc1b" kindref="member">mc_default_settings</ref>;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a7a5207ef389290242764f49c6c48a5ad" kindref="member">driving_loop_settings</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1a44daa1a9c68be860616e7bc627d9b8f4" kindref="member">default_dl_settings</ref>;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1af8dbf93ac51eb9fdc8911644d096486d" kindref="member">imd_settings</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1a1071bc1cceac3198de98d9c0753044d6" kindref="member">default_imd_settings</ref>;</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a6cdca5b5474080f1dff4d19ef96435e1" kindref="member">bms_settings</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1a28e4314b233b9140e73e4fd0bab7e354" kindref="member">default_bms_settings</ref>;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a6caecf0c9fd669e421c4005600d81b71" kindref="member">daq_settings</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" kindref="member">default_daq_settings</ref>;</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a191aefb9e6f4516a91157e5d6d68205b" kindref="member">daq_param_list</ref><sp/>=<sp/><ref refid="uvfr__settings_8c_1af5ab2cd7ec858145d49d4e585e4bef94" kindref="member">default_datapoints</ref>;<sp/></highlight><highlight class="comment">//Does<sp/>not<sp/>need<sp/>to<sp/>be<sp/>a<sp/>ptr,<sp/>since<sp/>this<sp/>is<sp/>an<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a01bbfda07b06d31224993ddf9745d285" kindref="member">pdu_settings</ref><sp/>=<sp/>&amp;<ref refid="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" kindref="member">default_pdu_settings</ref>;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1ae0c9377c4f8df54ad4b59d4ac4ab39fe" kindref="member">flags</ref><sp/>|=<sp/>0x0001;<sp/></highlight><highlight class="comment">//This<sp/>is<sp/>default<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="255"><highlight class="normal">}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="260" refid="uvfr__settings_8c_1a4648237563030182a8309d8c75e12205" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a4648237563030182a8309d8c75e12205" kindref="member">nukeSettings</ref>(<ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref>**<sp/>settings_to_delete){</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>uvFree(*settings_to_delete);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>*settings_to_delete<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal">}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="274" refid="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" kindref="member">uvLoadSettingsFromFlash</ref>(){</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvFree(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//real<sp/>trap<sp/>shit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>=<sp/>uvMalloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref>));</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a6a386c439058f4464e4b82acd1315258" kindref="member">veh_info</ref><sp/>=<sp/>(<ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref>*)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/>256*<ref refid="uvfr__settings_8h_1aa896deeb35bafb45b994e9c1d0c6500a" kindref="member">GENERAL_VEH_INFO_MGROUP</ref>+<ref refid="uvfr__settings_8h_1abcf807ab03bef940a111bb64cfffecfa" kindref="member">GENERAL_VEH_INFO_OFFSET</ref>);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1adbfed76ceedc0479ff023fea9ba7a84c" kindref="member">os_settings</ref><sp/>=<sp/>(<ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref>*)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1ae727eadb1cf71a3feeb12b7bb2eb83d5" kindref="member">OS_SETTINGS_MGROUP</ref>*256<sp/>+<sp/><ref refid="uvfr__settings_8h_1a012d0d54f18a0eeee83d89f5786db5d5" kindref="member">OS_SETTINGS_OFFSET</ref>);</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1ad0b0375d2c1674abc6f972eec47e9cb7" kindref="member">mc_settings</ref><sp/>=<sp/>(<ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref>*)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1aad0db57c7f8c7937be54192d7b74bdcf" kindref="member">MOTOR_MGROUP</ref>*256<sp/>+<sp/><ref refid="uvfr__settings_8h_1aa990a9c990001dc29a5ee5fdde3773e4" kindref="member">MOTOR_OFFSET</ref>);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a7a5207ef389290242764f49c6c48a5ad" kindref="member">driving_loop_settings</ref><sp/>=<sp/>(<ref refid="structdriving__loop__args" kindref="compound">driving_loop_args</ref>*)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1aaad501c2b79f55f1bbbae030b6a18dcd" kindref="member">DRIVING_MGROUP</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1a16f051ea34ee4f4965e4d11f3745d742" kindref="member">DRIVING_OFFSET</ref>);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1af8dbf93ac51eb9fdc8911644d096486d" kindref="member">imd_settings</ref><sp/>=<sp/><ref refid="uvfr__settings_8h_1ae99330d4904337e9a603ad2df6758b95" kindref="member">IMD_ADDR</ref>;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a6cdca5b5474080f1dff4d19ef96435e1" kindref="member">bms_settings</ref><sp/>=<sp/><ref refid="uvfr__settings_8h_1ab638ad0845e4b5e7007e314c83bc43d5" kindref="member">BMS_ADDR</ref>;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a6caecf0c9fd669e421c4005600d81b71" kindref="member">daq_settings</ref><sp/>=<sp/><ref refid="uvfr__settings_8h_1aae3049baf8d0bf80753c7b0da5ec8260" kindref="member">DAQ_HEAD_ADDR</ref>;</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a191aefb9e6f4516a91157e5d6d68205b" kindref="member">daq_param_list</ref><sp/>=<sp/><ref refid="uvfr__settings_8h_1ae385496a129924fb290839da5bfa90a2" kindref="member">DAQ_PARAMS1_ADDR</ref>;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref>-&gt;<ref refid="structuv__vehicle__settings_1a01bbfda07b06d31224993ddf9745d285" kindref="member">pdu_settings</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1aa77056695d9689ca6642d5b7176e33c9" kindref="member">PDU_MGROUP</ref>*256<sp/>+<sp/><ref refid="uvfr__settings_8h_1a8336472ba83c36033d7d4511a2e3b53e" kindref="member">PDU_OFFSET</ref>);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="299"><highlight class="normal">}</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="305" refid="uvfr__settings_8c_1a086bfc48f5a63b15586c6a2a8a1d29a8" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a086bfc48f5a63b15586c6a2a8a1d29a8" kindref="member">uvConfigSettingTask</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args){</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structuv__task__info" kindref="compound">uv_task_info</ref>*<sp/>setting_task<sp/>=<sp/><ref refid="group__state__engine__api_1ga99bfc92472cdc99e9005e9d3c792909a" kindref="member">uvCreateTask</ref>();</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(setting_task<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1ad24b438130bb3098ee5e855222dff21d" kindref="member">task_name</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Set_settings&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1afcd240d2b6b01b4acea600ef4dfe8fbc" kindref="member">task_function</ref><sp/>=<sp/><ref refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" kindref="member">uvSettingsProgrammerTask</ref>;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1aff45751f7189980589d55379d1d5a355" kindref="member">task_priority</ref><sp/>=<sp/><ref refid="group__state__engine__api_1gga6166ed80f8e3bd62f1e7e6122c8817f6a052e6887345173e8b7556738c28fa920" kindref="member">ABOVE_NORMAL</ref>;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1a353ec6bf2c42ab0920f3d1e671e568a3" kindref="member">stack_size</ref><sp/>=<sp/>512;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1ab24dea3bde4de2d839bf15e65c2df0d6" kindref="member">active_states</ref><sp/>=<sp/><ref refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4abed5371c079ef927fb67d8bb8e8aa286" kindref="member">PROGRAMMING</ref>;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1aafd4e2d916f50b54b99fd02d63831e43" kindref="member">suspension_states</ref><sp/>=<sp/>0x00;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1a6986d7216c7f889164931b37ab752c29" kindref="member">deletion_states</ref><sp/>=<sp/>0xFFFF<sp/>&amp;<sp/>~<ref refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4abed5371c079ef927fb67d8bb8e8aa286" kindref="member">PROGRAMMING</ref>;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1ad157811debce6672bb6d00da7e90b6ca" kindref="member">task_period</ref><sp/>=<sp/>20;</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/>setting_task-&gt;<ref refid="structuv__task__info_1ae255dff9b38fc8c0754085060e8ae699" kindref="member">task_args</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal">}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="334" refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1adc9522bb052011b07febe1235d1a4792" kindref="member">uvSettingsInit</ref>()<sp/>PRIVILEGED_FUNCTION{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga81adc4a577110ce8fe1158b0dc302cc2" kindref="member">insertCANMessageHandler</ref>(0x520,<ref refid="uvfr__settings_8c_1afa15631878f6d936a1143656f88f3620" kindref="member">handleIncomingLaptopMsg</ref>);<sp/></highlight><highlight class="comment">//Allows<sp/>us<sp/>to<sp/>talk<sp/>with<sp/>laptop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>=<sp/>uvMalloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__vehicle__settings" kindref="compound">uv_vehicle_settings</ref>));</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a03566822d1b8893362970a459bd67daf" kindref="member">current_vehicle_settings</ref><sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//HMMM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="uvfr__utils_8h_1a92b5ac44171d49acd084c274385a043a" kindref="member">__uvInitPanic</ref>();<sp/></highlight><highlight class="comment">//<sp/>deeply<sp/>unfortunate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//uvConfigSettingTask(current_vehicle_settings);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//First<sp/>we<sp/>check<sp/>the<sp/>validity<sp/>of<sp/>the<sp/>settings<sp/>in<sp/>flash.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_factory_default<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>force_flash_rewrite<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>for<sp/>existing<sp/>valid<sp/>flash<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/>retval<sp/>=<sp/><ref refid="uvfr__settings_8c_1a0be2604cded239f54f4f4ab61460a85c" kindref="member">uvValidateFlashSettings</ref>();</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(retval<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){<sp/></highlight><highlight class="comment">//If<sp/>the<sp/>thing<sp/>responds<sp/>with<sp/>OK,<sp/>then<sp/>we<sp/>attempt<sp/>to<sp/>load<sp/>flash<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" kindref="member">uvLoadSettingsFromFlash</ref>()<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Attempt<sp/>to<sp/>load<sp/>flash<sp/>settings.<sp/>If<sp/>that<sp/>somehow<sp/>fails,<sp/>revert<sp/>to<sp/>factory<sp/>defaults</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_factory_default<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1ae9ab130db00266635709bb7fb72c1844" kindref="member">uvLoadSettingsFromFlash</ref>()==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Could<sp/>not<sp/>actually<sp/>load<sp/>from<sp/>flash.<sp/>BAD!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//In<sp/>this<sp/>case<sp/>we<sp/>would<sp/>like<sp/>to<sp/>revert<sp/>to<sp/>factory<sp/>defaults!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_factory_default<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//In<sp/>this<sp/>case,<sp/>we<sp/>need<sp/>to<sp/>check<sp/>to<sp/>see<sp/>if<sp/>we<sp/>need<sp/>to<sp/>send<sp/>out<sp/>a<sp/>msg<sp/>for<sp/>the<sp/>VCU</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((uint32_t)(*(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/>4))){</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>)!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_factory_default<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>force_flash_rewrite<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(use_factory_default<sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">){</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" kindref="member">setupDefaultSettings</ref>()<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//great<sp/>success.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" kindref="member">setupDefaultSettings</ref>()<sp/>!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//FAILURE<sp/>TO<sp/>EVEN<sp/>LOAD<sp/>THE<sp/>DEFAULTS,<sp/>THIS<sp/>CAR<sp/>IS<sp/>UNDRIVEABLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="uvfr__utils_8h_1a92b5ac44171d49acd084c274385a043a" kindref="member">__uvInitPanic</ref>();</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(force_flash_rewrite<sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">){</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>tmp_sblock<sp/>=<sp/>uvMalloc(<ref refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" kindref="member">SETTING_BRANCH_SIZE</ref>);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87" kindref="member">uvResetFlashToDefault</ref>(tmp_sblock)==<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Things<sp/>to<sp/>do<sp/>upon<sp/>success<sp/>(this<sp/>thing<sp/>is<sp/>somewhat<sp/>self<sp/>explanitory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvFree(tmp_sblock);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1add1ebdaa7f93f2a43ca6afc6e05fdd44" kindref="member">setupDefaultSettings</ref>();</highlight><highlight class="comment">//<sp/>Temporary<sp/>and<sp/>forces<sp/>default<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal">}</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="411" refid="uvfr__settings_8c_1adfd1bb6988b37f38e799bb1f996ac005" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1adfd1bb6988b37f38e799bb1f996ac005" kindref="member">uvUpdateTmpSettings</ref>(uint8_t*<sp/>tmp_settings,<sp/>uint8_t<sp/>memgroup,<sp/>uint8_t<sp/>m_offset,<sp/>uint8_t<sp/>size,<sp/>uint8_t*<sp/>data){</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!tmp_settings){</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="415"><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(memgroup<sp/>&gt;<sp/>12){</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//out<sp/>of<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(((m_offset<sp/>+<sp/>size)%128)&lt;size){</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>for<sp/>certain<sp/>illegal<sp/>combinations<sp/>of<sp/>things<sp/>below:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//This<sp/>first<sp/>case<sp/>is<sp/>to<sp/>see<sp/>if<sp/>it<sp/>is<sp/>editing<sp/>the<sp/>reserved<sp/>area<sp/>of<sp/>the<sp/>sblock.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((memgroup<sp/>==<sp/>0)&amp;&amp;(m_offset<sp/>&lt;<sp/>32)){</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>offset<sp/>=<sp/>memgroup*256<sp/>+<sp/>m_offset;</highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;size;<sp/>i++){</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(tmp_settings<sp/>+<sp/>offset<sp/>+<sp/>i)<sp/>=<sp/>*(data<sp/>+<sp/>i);<sp/></highlight><highlight class="comment">//ensure<sp/>correct<sp/>number<sp/>comes<sp/>through.<sp/>//CONFIRMED<sp/>THIS<sp/>WORKS<sp/>IF<sp/>LAPTOP<sp/>SENDS<sp/>LITTLE<sp/>ENDIAN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="441"><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="445"><highlight class="normal">}</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight><highlight class="comment">//NOTE:<sp/>I<sp/>Have<sp/>not<sp/>finished<sp/>implementing<sp/>the<sp/>checksums<sp/>here.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448" refid="uvfr__settings_8c_1aec8886c47c65892251b444760cb30116" refkind="member"><highlight class="normal">uint32_t<sp/><ref refid="uvfr__settings_8c_1aec8886c47c65892251b444760cb30116" kindref="member">uvComputeChunkChecksum</ref>(uint32_t*<sp/>chunk){</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>tmp;</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>buf[9];</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>buf[8]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>8;<sp/>i++){</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf[i]<sp/>=<sp/>chunk[i];</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;<sp/>256;<sp/>i++){</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf[i/32]<sp/>^=<sp/>(<ref refid="uvfr__settings_8h_1a3a57af5c3275b2f53fa64274b11e8d52" kindref="member">CRC_POLY</ref><sp/>&lt;&lt;<sp/>i%32);</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="461"><highlight class="normal">}</highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight></codeline>
<codeline lineno="463" refid="uvfr__settings_8c_1a90cba009630be4dc991f7de6cbede4d8" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a90cba009630be4dc991f7de6cbede4d8" kindref="member">uvComputeMemRegionChecksum</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>sblock,<sp/>uint32_t*<sp/>csums<sp/>,</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>mregion){</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;32<sp/>;<sp/>i++){</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(csums<sp/>+<sp/>i*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(uint32_t))<sp/>=<sp/><ref refid="uvfr__settings_8c_1aec8886c47c65892251b444760cb30116" kindref="member">uvComputeChunkChecksum</ref>(sblock<sp/>+<sp/>i*8*4);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal">}</highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight></codeline>
<codeline lineno="472" refid="uvfr__settings_8c_1aee72930bcdad229cbe8a8adb73e4a3b3" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1aee72930bcdad229cbe8a8adb73e4a3b3" kindref="member">uvComputeSettingsChecksums</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>sblock,<sp/>uint32_t*<sp/>csums){</highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Compute<sp/>the<sp/>checksums<sp/>of<sp/>the<sp/>sblock</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//8<sp/>to<sp/>1<sp/>reducgtion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/>retval<sp/>=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>12;<sp/>i++){</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retval<sp/>=<sp/><ref refid="uvfr__settings_8c_1a90cba009630be4dc991f7de6cbede4d8" kindref="member">uvComputeMemRegionChecksum</ref>(sblock,<sp/>csums,<sp/>i);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(retval<sp/>!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>retval;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal">}</highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495" refid="uvfr__settings_8c_1a84fc0703372fd83581befabb9fba3858" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a84fc0703372fd83581befabb9fba3858" kindref="member">uvValidateChecksums</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>sblock){</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t*<sp/>csums<sp/>=<sp/>uvMalloc(512);</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(csums<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//BIG<sp/>UHH<sp/>OHH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1aee72930bcdad229cbe8a8adb73e4a3b3" kindref="member">uvComputeSettingsChecksums</ref>(sblock,<sp/>csums);</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal">}</highlight></codeline>
<codeline lineno="507"><highlight class="normal"></highlight></codeline>
<codeline lineno="511" refid="uvfr__settings_8c_1a2284c8b3e2b6e434f6a1d322396efdb2" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a2284c8b3e2b6e434f6a1d322396efdb2" kindref="member">uvSBlockCorruptionHandler</ref>()<sp/>PRIVILEGED_FUNCTION{</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//We<sp/>need<sp/>to<sp/>forcibly<sp/>revert<sp/>to<sp/>factory<sp/>default.<sp/>Unsure<sp/>about<sp/>ability<sp/>to<sp/>write<sp/>to<sp/>flash.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>addr<sp/>=<sp/><ref refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" kindref="member">FLASH_SBLOCK_START</ref>;</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>successful_write<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/>taskENTER_CRITICAL();</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;3;<sp/>i++){</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Unlock()<sp/>==<sp/>HAL_OK){</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/>__HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP<sp/>|<sp/>FLASH_FLAG_OPERR<sp/>|<sp/>FLASH_FLAG_WRPERR<sp/>|<sp/>FLASH_FLAG_PGAERR<sp/>|<sp/>FLASH_FLAG_PGSERR<sp/>|<sp/>FLASH_FLAG_PGPERR);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Set<sp/>the<sp/>start<sp/>of<sp/>the<sp/>Sblock<sp/>to<sp/>0,<sp/>therefore<sp/>causing<sp/>uvValidate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Program(FLASH_TYPEPROGRAM_WORD,(uint32_t)addr,0x00000000)!=<sp/>HAL_OK){</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>this<sp/>does<sp/>not<sp/>work,<sp/>then<sp/>more<sp/>drastic<sp/>measures<sp/>may<sp/>be<sp/>needed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Manually<sp/>erase<sp/>entire<sp/>sector<sp/>in<sp/>hardware.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Note<sp/>that<sp/>this<sp/>will<sp/>also<sp/>destroy<sp/>any<sp/>persistent<sp/>data,<sp/>but<sp/>we<sp/>have<sp/>genuinely<sp/>much<sp/>bigger<sp/>fish<sp/>to<sp/>fry<sp/>at<sp/>this<sp/>point,<sp/>like<sp/>the<sp/>literal<sp/>vehicle<sp/>settings<sp/>are<sp/>corrupted<sp/>WTF<sp/>do<sp/>you<sp/>want<sp/>from<sp/>me,<sp/>man?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((FLASH-&gt;SR)<sp/>&amp;<sp/>FLASH_SR_BSY){</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Wait<sp/>till<sp/>no<sp/>longer<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>(FLASH_CR_SNB_0<sp/>|<sp/>FLASH_CR_SNB_1<sp/>|<sp/>FLASH_CR_SNB_3);<sp/></highlight><highlight class="comment">//<sp/>Sector<sp/>11</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>FLASH_CR_SER;<sp/></highlight><highlight class="comment">//Queue<sp/>up<sp/>a<sp/>flash<sp/>erase<sp/>operation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>FLASH_CR_STRT;<sp/></highlight><highlight class="comment">//Tells<sp/>the<sp/>hardware<sp/>to<sp/>begin<sp/>flash<sp/>clear<sp/>procces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((FLASH-&gt;SR)<sp/>&amp;<sp/>FLASH_SR_BSY){</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Wait<sp/>till<sp/>no<sp/>longer<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/>HAL_FLASH_Lock();</highlight><highlight class="comment">//Always<sp/>remember<sp/>to<sp/>lock<sp/>the<sp/>flash.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/>taskEXIT_CRITICAL();</highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal">};</highlight></codeline>
<codeline lineno="553"><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight></codeline>
<codeline lineno="555" refid="uvfr__settings_8c_1a36192e27458271ff052029579febb5a1" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a36192e27458271ff052029579febb5a1" kindref="member">uvOverwriteCsr</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>sblock,<sp/>uint32_t*<sp/>csr){</highlight></codeline>
<codeline lineno="556"><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="558"><highlight class="normal">}</highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight></codeline>
<codeline lineno="563" refid="uvfr__settings_8c_1a65bd5632c9f844eac3ead2787cb1375c" refkind="member"><highlight class="preprocessor">#define<sp/>FLASH_OK<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="564" refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>INVALID_SBLOCK<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565" refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>FLASH_NOT_UNLOCKED<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566" refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DID_NOT_FINISH_PROGRAMMING<sp/>3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567" refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DATA_MISMATCH<sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568" refid="uvfr__settings_8c_1a4fc65d72946e3e169f15ed0015fa3d3c" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>PRE_CHECKSUM<sp/>5</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569" refid="uvfr__settings_8c_1a1e63b2fed237e9d016b304884c01457b" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>POST_CHECKSUM<sp/>6</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"></highlight></codeline>
<codeline lineno="574" refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" kindref="member">uvSaveSettingsToFlash</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>sblock,<sp/>uint32_t*<sp/>ecode)<sp/>PRIVILEGED_FUNCTION{</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(sblock<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ecode<sp/>=<sp/><ref refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" kindref="member">INVALID_SBLOCK</ref>;</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="579"><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>tmp<sp/>=<sp/>sblock;</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>if(uvValidateChecksums(tmp)<sp/>!=<sp/>UV_OK){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>UV_ABORTED;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint32_t*)(tmp<sp/>+<sp/>0))<sp/>=<sp/><ref refid="uvfr__settings_8h_1a54061e5993a5517320d425f44408cc86" kindref="member">MAGIC_NUMBER</ref>;<sp/></highlight><highlight class="comment">//Identifies<sp/>that<sp/>this<sp/>is<sp/>in<sp/>fact<sp/>a<sp/>valid<sp/>S_Block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint32_t*)(tmp<sp/>+<sp/>4))<sp/>=<sp/>0x00000001;<sp/></highlight><highlight class="comment">//Little<sp/>reminder<sp/>for<sp/>future<sp/>VCU<sp/>that<sp/>the<sp/>settings<sp/>were<sp/>recently<sp/>changed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint16_t*)(tmp<sp/>+<sp/>8))<sp/>=<sp/>0x1000;</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint16_t*)(tmp<sp/>+<sp/>10))<sp/>=<sp/><ref refid="uvfr__global__config_8h_1a0b584a8bce5bc95619d58d126328d24d" kindref="member">FIRMWARE_MAJOR_RELEASE</ref>;<sp/></highlight><highlight class="comment">//Identify<sp/>the<sp/>firmware<sp/>version<sp/>this<sp/>is</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint16_t*)(tmp<sp/>+<sp/>12))<sp/>=<sp/><ref refid="uvfr__global__config_8h_1a2ada82deacaaa65d39fd8431202312e8" kindref="member">FIRMWARE_MINOR_RELEASE</ref>;<sp/></highlight><highlight class="comment">//Identify<sp/>the<sp/>firmware<sp/>version</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint16_t*)(tmp<sp/>+<sp/>14))<sp/>=<sp/><ref refid="uvfr__global__config_8h_1a056c3375923e87e7b3df830ea10295da" kindref="member">FIRMWARE_PATCH_NUM</ref>;</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//We<sp/>save<sp/>the<sp/>sizes<sp/>of<sp/>the<sp/>core<sp/>setting<sp/>structs,<sp/>so<sp/>that<sp/>if<sp/>someone<sp/>adds<sp/>or<sp/>removes<sp/>settings<sp/>from<sp/>the<sp/>struct,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//The<sp/>program<sp/>will<sp/>notice<sp/>and<sp/>load<sp/>factory<sp/>defaults<sp/>into<sp/>flash</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>16))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref>);</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>17))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref>);</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>18))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref>);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>19))<sp/>=<sp/>(uint8_t)</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="driving__loop_8h_1aa421e50f529a1770ef0b2a00a44a0601" kindref="member">driving_loop_args</ref>);<sp/></highlight><highlight class="comment">//IDGAF<sp/>if<sp/>we<sp/>got<sp/>truncation<sp/>error<sp/>here,<sp/>fuck<sp/>you</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>20))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref>);</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>21))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structbms__settings__t" kindref="compound">bms_settings_t</ref>);</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>22))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref>);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>23))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdaq__datapoint" kindref="compound">daq_datapoint</ref>);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint8_t*)(tmp<sp/>+<sp/>24))<sp/>=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv19__pdu__settings" kindref="compound">uv19_pdu_settings</ref>);</highlight></codeline>
<codeline lineno="603"><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>addr<sp/>=<sp/><ref refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" kindref="member">FLASH_SBLOCK_START</ref>;</highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Unlock()<sp/>!=<sp/>HAL_OK){</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ecode<sp/>=<sp/><ref refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" kindref="member">FLASH_NOT_UNLOCKED</ref>;</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="612"><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/>taskENTER_CRITICAL();<sp/></highlight><highlight class="comment">//I<sp/>would<sp/>very<sp/>much<sp/>prefer<sp/>if<sp/>nothing<sp/>fucks<sp/>with<sp/>this</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((FLASH-&gt;SR)<sp/>&amp;<sp/>FLASH_SR_BSY){</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Wait<sp/>till<sp/>no<sp/>longer<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>(FLASH_CR_SNB_0<sp/>|<sp/>FLASH_CR_SNB_1<sp/>|<sp/>FLASH_CR_SNB_3);<sp/></highlight><highlight class="comment">//<sp/>Sector<sp/>11</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>FLASH_CR_SER;<sp/></highlight><highlight class="comment">//Queue<sp/>up<sp/>a<sp/>flash<sp/>erase<sp/>operation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>FLASH_CR_STRT;<sp/></highlight><highlight class="comment">//Tells<sp/>the<sp/>hardware<sp/>to<sp/>begin<sp/>flash<sp/>clear<sp/>procces</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">((FLASH-&gt;SR)<sp/>&amp;<sp/>FLASH_SR_BSY){</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Wait<sp/>till<sp/>no<sp/>longer<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(addr<sp/>&lt;<sp/><ref refid="uvfr__settings_8h_1aa81180ef8eb37ec6e7d99d706610680d" kindref="member">TOP_OF_FLASH_SBLOCK</ref>){<sp/></highlight><highlight class="comment">//TODO<sp/>Is<sp/>this<sp/>the<sp/>right<sp/>address?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP<sp/>|<sp/>FLASH_FLAG_OPERR<sp/>|<sp/>FLASH_FLAG_WRPERR<sp/>|<sp/>FLASH_FLAG_PGAERR<sp/>|<sp/>FLASH_FLAG_PGSERR<sp/>|<sp/>FLASH_FLAG_PGPERR);</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Program(FLASH_TYPEPROGRAM_WORD,(uint32_t)addr,(uint32_t)(*(uint32_t*)tmp))!=<sp/>HAL_OK){</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//ERROR<sp/>ERROR<sp/>AHHHH<sp/>FUCK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//uvPanic(&quot;FLASH_WRITE_ERROR&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ecode<sp/>=<sp/><ref refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" kindref="member">DID_NOT_FINISH_PROGRAMMING</ref>;</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HAL_FLASH_Lock();</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>addr<sp/>+=<sp/>4;</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>+=<sp/>4;</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>we<sp/>reach<sp/>this<sp/>point<sp/>then<sp/>the<sp/>BSY<sp/>bit<sp/>of<sp/>FLASH_SR<sp/>register<sp/>is<sp/>not<sp/>set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Clear<sp/>these<sp/>error<sp/>flags</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>FLASH-&gt;SR<sp/>|=<sp/>(FLASH_SR_PGSERR<sp/>|<sp/>FLASH_SR_PGPERR<sp/>|<sp/>FLASH_SR_PGAERR<sp/>|<sp/>FLASH_SR_WRPERR);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>(FLASH_CR_PSIZE_0<sp/>|<sp/>FLASH_CR_PSIZE_1);<sp/>//64<sp/>byte<sp/>alignment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>FLASH_CR_PG;<sp/>//<sp/>Program<sp/>enable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>while(addr<sp/>&lt;<sp/>TOP_OF_FLASH_SBLOCK){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>while((FLASH-&gt;SR<sp/>&amp;<sp/>FLASH_SR_BSY)==1){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//Dont<sp/>be<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>*((uint64_t*)addr)<sp/>=<sp/>*((uint64_t*)tmp);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>addr<sp/>+=<sp/>8;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>+=<sp/>8;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if(FLASH-&gt;SR<sp/>&amp;<sp/>(FLASH_SR_PGSERR<sp/>|<sp/>FLASH_SR_PGPERR<sp/>|<sp/>FLASH_SR_PGAERR<sp/>|<sp/>FLASH_SR_WRPERR)){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//An<sp/>error<sp/>bit<sp/>has<sp/>been<sp/>set.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ecode<sp/>=<sp/>DID_NOT_FINISH_PROGRAMMING;<sp/>//UHH<sp/>OH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>while((FLASH-&gt;SR)<sp/>&amp;<sp/>FLASH_SR_BSY){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//Wait<sp/>till<sp/>no<sp/>longer<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>FLASH-&gt;CR<sp/>&amp;=<sp/>(~FLASH_CR_PG);<sp/>//Disable<sp/>the<sp/>programming</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>while((FLASH-&gt;SR)<sp/>&amp;<sp/>FLASH_SR_BSY){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//Wait<sp/>till<sp/>no<sp/>longer<sp/>busy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/>FLASH-&gt;CR<sp/>|=<sp/>FLASH_CR_LOCK;<sp/></highlight><highlight class="comment">//LOCK<sp/>FLASH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/>taskEXIT_CRITICAL();</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>HAL_FLASH_Lock();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>to<sp/>make<sp/>sure<sp/>the<sp/>two<sp/>match</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>sblock;</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/>addr<sp/>=<sp/><ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref>;</highlight></codeline>
<codeline lineno="693"><highlight class="normal"></highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(addr<sp/>&lt;<sp/><ref refid="uvfr__settings_8h_1aa81180ef8eb37ec6e7d99d706610680d" kindref="member">TOP_OF_FLASH_SBLOCK</ref>){</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint32_t*)tmp)<sp/>!=<sp/>*((uint32_t*)addr)){</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ecode<sp/>=<sp/><ref refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" kindref="member">DATA_MISMATCH</ref>;</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;<sp/></highlight><highlight class="comment">//Mismatch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>+=<sp/>4;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>addr<sp/>+=<sp/>4;</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>if(uvValidateChecksums(START_OF_USER_FLASH)!=<sp/>UV_OK){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>UV_ERROR;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal">}</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="716" refid="uvfr__settings_8c_1a30c09e445d8f0fbfbdfd1bfa0fcfdc67" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a30c09e445d8f0fbfbdfd1bfa0fcfdc67" kindref="member">uvSetSettingResponseReminder</ref>(uint32_t<sp/>reminder){</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Unlock()<sp/>!=<sp/>HAL_OK){</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Program(FLASH_TYPEPROGRAM_WORD,(uint32_t)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/>4),(uint32_t)&amp;reminder)!=HAL_OK){</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HAL_FLASH_Lock();</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HAL_FLASH_Lock();</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="728"><highlight class="normal">}</highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight></codeline>
<codeline lineno="735" refid="uvfr__settings_8c_1a8e128ab49bfb636a4597802418066784" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a8e128ab49bfb636a4597802418066784" kindref="member">uvForceDefaultReversionUponDeviceReset</ref>(){</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>word<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="737"><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Unlock()<sp/>!=<sp/>HAL_OK){</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(HAL_FLASH_Program(FLASH_TYPEPROGRAM_WORD,(uint32_t)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref>),(uint32_t)&amp;word)!=HAL_OK){</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HAL_FLASH_Lock();</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/>HAL_FLASH_Lock();</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="749"><highlight class="normal">}</highlight></codeline>
<codeline lineno="750"><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight></codeline>
<codeline lineno="756" refid="uvfr__settings_8c_1a53df36781d38254cb6bbe6717e6ebae0" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/><ref refid="uvfr__settings_8c_1a53df36781d38254cb6bbe6717e6ebae0" kindref="member">uvCreateTmpSettingsCopy</ref>(){</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/>uint64_t*<sp/>sblock<sp/>=<sp/>uvMalloc(<ref refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" kindref="member">SETTING_BRANCH_SIZE</ref>);</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(sblock<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="760"><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/>uint64_t*<sp/>tmp<sp/>=<sp/>(uint64_t*)(<ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref>);</highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" kindref="member">SETTING_BRANCH_SIZE</ref>;<sp/>i<sp/>+=<sp/>8){</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*(sblock<sp/>+<sp/>i)<sp/>=<sp/>*(tmp<sp/>+<sp/>i);</highlight></codeline>
<codeline lineno="767"><highlight class="normal"></highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="769"><highlight class="normal"></highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*)sblock;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal">}</highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="778" refid="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" kindref="member">uvSendSpecificParam</ref>(uint8_t*<sp/>origin,<sp/>uint8_t<sp/>mgroup,<sp/>uint8_t<sp/>m_offset,<sp/>uint8_t<sp/>size){</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref><sp/>blank_msg;</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1a3a3fdc7fed06a631fefa58ea44052d8d" kindref="member">flags</ref><sp/>=<sp/>0x00;</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aae369fbabe3cc5b71a89bb641c24aace" kindref="member">msg_id</ref><sp/>=<sp/>0x420;</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[0]<sp/>=<sp/>0b00100000<sp/>|<sp/>mgroup;</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[1]<sp/>=<sp/>m_offset;</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aa74af3745c8b56910d7c309245541d37" kindref="member">dlc</ref><sp/>=<sp/>2<sp/>+<sp/>size;</highlight></codeline>
<codeline lineno="785"><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t*<sp/>ptr<sp/>=<sp/><ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref><sp/>+<sp/>256*mgroup<sp/>+<sp/>m_offset;</highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;4<sp/>;i++){</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blank_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[2+i]<sp/>=<sp/>*(ptr+i);</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;blank_msg)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="795"><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="797"><highlight class="normal">}</highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight></codeline>
<codeline lineno="810" refid="uvfr__settings_8c_1a0be2604cded239f54f4f4ab61460a85c" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a0be2604cded239f54f4f4ab61460a85c" kindref="member">uvValidateFlashSettings</ref>(){</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>tmp<sp/>=<sp/><ref refid="uvfr__settings_8h_1a3e4cc3b6b2019eb461b9cd99ff70f1e7" kindref="member">START_OF_USER_FLASH</ref>;</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint32_t*)tmp)<sp/>!=<sp/><ref refid="uvfr__settings_8h_1a54061e5993a5517320d425f44408cc86" kindref="member">MAGIC_NUMBER</ref>){</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight><highlight class="comment">//<sp/>Nice<sp/>blank<sp/>slate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="815"><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//NEXT<sp/>we<sp/>check<sp/>the<sp/>firmware<sp/>number,<sp/>and<sp/>that<sp/>nobody<sp/>screwed<sp/>around<sp/>with<sp/>the<sp/>struct<sp/>contents</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"></highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>any<sp/>of<sp/>these<sp/>dont<sp/>match,<sp/>then<sp/>the<sp/>firmware<sp/>does<sp/>not<sp/>match<sp/>the<sp/>settings<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>16))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref>)){</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<sp/>*((uint8_t*)(tmp<sp/>+<sp/>17))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref>)){</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>18))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref>)){</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="831"><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>19))<sp/>!=<sp/>(uint8_t)(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdriving__loop__args" kindref="compound">driving_loop_args</ref>))){</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>20))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref>)){</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>21))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structbms__settings__t" kindref="compound">bms_settings_t</ref>)){</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>22))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref>)){</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="847"><highlight class="normal"></highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>23))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdaq__datapoint" kindref="compound">daq_datapoint</ref>)){</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(*((uint8_t*)(tmp<sp/>+<sp/>24))<sp/>!=<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv19__pdu__settings" kindref="compound">uv19_pdu_settings</ref>)){</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="855"><highlight class="normal"></highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="857"><highlight class="normal">}</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="864" refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a2f0cb7e05c1bef0501d585df7c2c6013" kindref="member">uvSettingsProgrammerTask</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args)<sp/>PRIVILEGED_FUNCTION{</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structuv__task__info" kindref="compound">uv_task_info</ref>*<sp/>params<sp/>=<sp/>(<ref refid="structuv__task__info" kindref="compound">uv_task_info</ref>*)<sp/>args;</highlight></codeline>
<codeline lineno="866"><highlight class="normal"></highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>mgroup<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>m_offset<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>d_type<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>d_size<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="871"><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>cmd_byte<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="873"><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t*<sp/>origin<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="875"><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref><sp/>tmp_msg;<sp/></highlight><highlight class="comment">//messages<sp/>get<sp/>written<sp/>into<sp/>here<sp/>when</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>new_tmp_settings<sp/>=<sp/><ref refid="uvfr__settings_8c_1a53df36781d38254cb6bbe6717e6ebae0" kindref="member">uvCreateTmpSettingsCopy</ref>();</highlight></codeline>
<codeline lineno="879"><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_tmp_settings<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Did<sp/>not<sp/>create<sp/>temp<sp/>settings<sp/>&gt;:(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);<sp/></highlight><highlight class="comment">//Let<sp/>laptop<sp/>know<sp/>of<sp/>our<sp/>failures</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="884"><highlight class="normal"></highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a6726b669a3c5795c3326238ab974f382" kindref="member">ptask_handle</ref><sp/>=<sp/>params-&gt;<ref refid="structuv__task__info_1a5347f41c4b15b2d6b039c339613fde43" kindref="member">task_handle</ref>;</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//uvSendCanMSG(&amp;vcu_ack_msg);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" kindref="member">settings_queue</ref><sp/>=<sp/>xQueueCreate(8,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv___c_a_n__msg" kindref="compound">uv_CAN_msg</ref>));</highlight></codeline>
<codeline lineno="890"><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" kindref="member">settings_queue</ref><sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvPanic(</highlight><highlight class="stringliteral">&quot;Settings<sp/>Queue<sp/>Not<sp/>Created&quot;</highlight><highlight class="normal">,0);</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Cached<sp/>temporary<sp/>variables<sp/>for<sp/>incoming<sp/>programming<sp/>messages</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="898"><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>);<sp/></highlight><highlight class="comment">//successfully<sp/>entered<sp/>the<sp/>task</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(;;){</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(xQueueReceive(<ref refid="uvfr__settings_8c_1aa3e729b05a7d2931a9a1e55f52bca3c7" kindref="member">settings_queue</ref>,&amp;tmp_msg,100)!=pdTRUE){</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//laptop<sp/>connection<sp/>lost.<sp/>Yowza.<sp/>Discard<sp/>whatever<sp/>you&apos;re<sp/>doin.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if((xTaskGetTickCount()<sp/>-<sp/>last_contact_with_laptop)<sp/>&gt;<sp/>200){</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="906"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//more<sp/>than<sp/>200ms<sp/>have<sp/>passed<sp/>since<sp/>last<sp/>communication.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="907"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>changeVehicleState(UV_READY);<sp/>//<sp/>leave<sp/>the<sp/>task</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="910"><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>WARNING:<sp/>This<sp/>is<sp/>a<sp/>goto.<sp/>I<sp/>know<sp/>goto<sp/>is<sp/>prety<sp/>heinous.</highlight></codeline>
<codeline lineno="912"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="913"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>__END_OF_SETTING_TASK_LOOP__;</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="916"><highlight class="normal"></highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cmd_byte<sp/>=<sp/>tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[0];</highlight></codeline>
<codeline lineno="918"><highlight class="normal"></highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(cmd_byte){</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a7091f0610d47127e952576fcf2d72eac" kindref="member">SET_SPECIFIC_PARAM</ref><sp/>...<sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694aefd2ddc079bf62b63b3e5226b9a83ac3" kindref="member">END_OF_SPECIFIC_PARAMS</ref>:</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mgroup<sp/>=<sp/>(cmd_byte<sp/>&amp;(0b00011111));</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_offset<sp/>=<sp/>tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[1];</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d_type<sp/>=<sp/>tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[2];</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d_size<sp/>=<sp/><ref refid="uvfr__utils_8h_1a657e7e858d8847396634fd9912747f8b" kindref="member">data_size</ref>[d_type];</highlight></codeline>
<codeline lineno="925"><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1adfd1bb6988b37f38e799bb1f996ac005" kindref="member">uvUpdateTmpSettings</ref>(new_tmp_settings,<sp/>mgroup,<sp/>m_offset,<sp/>d_size,<sp/>(tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref><sp/>+<sp/>3))<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Send<sp/>back<sp/>an<sp/>ACK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>);</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//reply<sp/>that<sp/>it<sp/>failed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"></highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a9b0e526098fd6c30dc93538edba59405" kindref="member">REQUEST_ALL_SETTINGS</ref>:</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Well<sp/>I<sp/>guess<sp/>now<sp/>we<sp/>gotta<sp/>transmit<sp/>the<sp/>whole<sp/>shabang</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Time<sp/>for<sp/>probably<sp/>the<sp/>most<sp/>fucked<sp/>task<sp/>I&apos;ve<sp/>done<sp/>in<sp/>a<sp/>hot<sp/>minute</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a205322c736d66df92b6d968b53648acb" kindref="member">REQUEST_ALL_JOURNAL_ENTRIES</ref>:</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//This<sp/>is<sp/>not<sp/>yet<sp/>implemented.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a4313d65a75fd41f3e527b330e7370a5e" kindref="member">REQUEST_JOURNAL_ENTRIES_BY_TIME</ref>:</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//This<sp/>is<sp/>not<sp/>yet<sp/>implemented</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694ac53400ee472ace47006a18aaaa4a86a0" kindref="member">REQUEST_SPECIFIC_SETTING</ref>:</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//We<sp/>wish<sp/>to<sp/>know<sp/>the<sp/>value<sp/>of<sp/>a<sp/>specific<sp/>setting</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mgroup<sp/>=<sp/>tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[2];</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_offset<sp/>=<sp/>tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[3];</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d_type<sp/>=<sp/>tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[4];</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d_size<sp/>=<sp/><ref refid="uvfr__utils_8h_1a657e7e858d8847396634fd9912747f8b" kindref="member">data_size</ref>[d_type];</highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin<sp/>=<sp/>(tmp_msg.<ref refid="structuv___c_a_n__msg_1aec63cc112176da7895d0cfc8b32e6935" kindref="member">data</ref>[1])?<sp/><ref refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" kindref="member">FLASH_SBLOCK_START</ref><sp/>:<sp/>new_tmp_settings;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" kindref="member">uvSendSpecificParam</ref>(origin,mgroup,m_offset,d_size)<sp/>!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//HANDLE<sp/>THIS<sp/>ERROR<sp/>HERE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a8ad6825ef0a84f2615148dc63202be1f" kindref="member">SAVE_AND_APPLY_NEW_SETTINGS</ref>:</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Save<sp/>and<sp/>apply.<sp/>Hoo<sp/>boy.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>ecode<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" kindref="member">uvSaveSettingsToFlash</ref>(new_tmp_settings,<sp/>&amp;ecode)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Try<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>);<sp/></highlight><highlight class="comment">//report<sp/>success</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" kindref="member">uvSaveSettingsToFlash</ref>(new_tmp_settings,<sp/>&amp;ecode)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Try<sp/>again</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>);</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//This<sp/>is<sp/>a<sp/>tricky<sp/>one.<sp/>High<sp/>probability<sp/>of<sp/>data<sp/>corruption.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" kindref="member">INVALID_SBLOCK</ref>){</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Womp<sp/>womp,<sp/>the<sp/>SBLOCK<sp/>you<sp/>provided<sp/>is<sp/>not<sp/>ok</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" kindref="member">FLASH_NOT_UNLOCKED</ref>){</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Failure<sp/>to<sp/>unlock<sp/>flash.<sp/>Why?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" kindref="member">DID_NOT_FINISH_PROGRAMMING</ref>){</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Partially<sp/>programmed.<sp/>Indicates<sp/>data<sp/>has<sp/>been<sp/>corrupted.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//FORCE<sp/>RESET,<sp/>CANNOT<sp/>CONTINUE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" kindref="member">DATA_MISMATCH</ref>){</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Data<sp/>in<sp/>flash<sp/>does<sp/>not<sp/>match<sp/>what<sp/>has<sp/>been<sp/>programmed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//FORCE<sp/>RESET,<sp/>CANNOT<sp/>CONTINUE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a4fc65d72946e3e169f15ed0015fa3d3c" kindref="member">PRE_CHECKSUM</ref>){</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Checksum<sp/>failure<sp/>of<sp/>sblock<sp/>prior<sp/>to<sp/>save<sp/>attempt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a1e63b2fed237e9d016b304884c01457b" kindref="member">POST_CHECKSUM</ref>){</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Checksum<sp/>failure<sp/>of<sp/>flash,<sp/>post<sp/>save<sp/>-<sp/>CORRUPTION</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>!=<sp/>0){</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>section<sp/>of<sp/>code<sp/>is<sp/>one<sp/>of<sp/>the<sp/>worst<sp/>places<sp/>to<sp/>be<sp/>in<sp/>the<sp/>vehicle.</highlight></codeline>
<codeline lineno="990"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="991"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="994"><highlight class="normal"></highlight></codeline>
<codeline lineno="995"><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a485f41f6d806239622abbac7aef60557" kindref="member">DISCARD_NEW_SETTINGS</ref>:</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(uvFree(new_tmp_settings)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>new_tmp_settings<sp/>=<sp/><ref refid="uvfr__settings_8c_1a53df36781d38254cb6bbe6717e6ebae0" kindref="member">uvCreateTmpSettingsCopy</ref>();</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"></highlight></codeline>
<codeline lineno="1001"><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_tmp_settings<sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>);</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//This<sp/>means<sp/>that<sp/>we<sp/>have<sp/>succeeded,<sp/>as<sp/>we<sp/>have<sp/>deleted<sp/>the<sp/>old<sp/>settings,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//and<sp/>new<sp/>settings<sp/>have<sp/>taken<sp/>their<sp/>place</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvPanic(</highlight><highlight class="stringliteral">&quot;uhh<sp/>oh&quot;</highlight><highlight class="normal">,0);</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Not<sp/>OK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af7c7d49fd92c65119717ab40db8725f5" kindref="member">vcu_ack_failed_msg</ref>);</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvPanic(</highlight><highlight class="stringliteral">&quot;uhh<sp/>oh&quot;</highlight><highlight class="normal">,0);</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694abe34f5f2d055215f2ff2e2d85401199a" kindref="member">DISCARD_NEW_SETTINGS_AND_EXIT</ref>:</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//uvFree(new_tmp_settings);<sp/>//No<sp/>need<sp/>to<sp/>free,<sp/>this<sp/>happens<sp/>in<sp/>the<sp/>destructor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__state__engine__api_1gaa3ad3e8df75177c00265881c16563212" kindref="member">changeVehicleState</ref>(<ref refid="group__state__engine__api_1gga259abff5a03eaf908dc8f03d99f478e4a9ec1eef180c6208b25b08f0526dc5eb8" kindref="member">UV_READY</ref>);</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__uvfr__can__api_1ga62414944c3b631f57fdd08e467bcf5a4" kindref="member">uvSendCanMSG</ref>(&amp;<ref refid="uvfr__settings_8c_1af3e753b2f0a1841e5e54714979b93491" kindref="member">vcu_ack_msg</ref>);</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8h_1aeee8696051cb8180af8de030b0927694a302a39661f2460e559645419a2ac8258" kindref="member">FORCE_RESTORE_FACTORY_DEFAULT</ref>:</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87" kindref="member">uvResetFlashToDefault</ref>(new_tmp_settings)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Success</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//failure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//unrecognized<sp/>command<sp/>spotted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"></highlight></codeline>
<codeline lineno="1036"><highlight class="normal"></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__END_OF_SETTING_TASK_LOOP__:</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(params-&gt;<ref refid="structuv__task__info_1af532b5031cd6a168a3ec45ab9ead4f23" kindref="member">cmd_data</ref><sp/>==<sp/><ref refid="group__state__engine__api_1ggaf11e8677926913f2dd803fabbed3455ca0e75e398c2bbcb663eaeb98684ca69d6" kindref="member">UV_KILL_CMD</ref>){</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TODO<sp/>add<sp/>destructors<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_tmp_settings<sp/>!=<sp/>NULL){</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvFree(new_tmp_settings);</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"></highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__state__engine__backend_1ga5f35b34432afed7f18f91fb8607f096f" kindref="member">killSelf</ref>(params);<sp/></highlight><highlight class="comment">//Me<sp/>too<sp/>programming<sp/>and<sp/>diagnostics<sp/>task,<sp/>me<sp/>too</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(1){<sp/></highlight><highlight class="comment">//hang</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"></highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1052"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"></highlight></codeline>
<codeline lineno="1054"><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal"></highlight></codeline>
<codeline lineno="1056"><highlight class="normal"></highlight></codeline>
<codeline lineno="1057" refid="uvfr__settings_8c_1a5f5ab3b99bc259455a2ec79144422450" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1ac9480e8bfbccfda4b4c7316bdb55ba87" kindref="member">uvResetFlashToDefault</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>new_sblock){</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//void*<sp/>new_sblock<sp/>=<sp/>uvMalloc(SETTING_BRANCH_SIZE);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1059"><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(new_sblock<sp/>==<sp/>NULL){</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;<sp/></highlight><highlight class="comment">//definately<sp/>not<sp/>ideal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;<ref refid="uvfr__settings_8h_1ae3422980a714e1a061dc8c4685a1d613" kindref="member">SETTING_BRANCH_SIZE</ref>;<sp/>i<sp/>+=<sp/>4){</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*((uint32_t*)(new_sblock<sp/>+<sp/>i))<sp/>=<sp/>0xFFFFFFFF;</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="comment">//Become<sp/>Zeros</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/>*((uint32_t*)(new_sblock))<sp/>=<sp/><ref refid="uvfr__settings_8h_1a54061e5993a5517320d425f44408cc86" kindref="member">MAGIC_NUMBER</ref>;</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"></highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//uint32_t<sp/>pdiff<sp/>=<sp/>((uint32_t)new_sblock)<sp/>-<sp/>((uint32_t)START_OF_USER_FLASH);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="uvfr__settings_8c_1a550e75d7673e407aad1a5240ff83db23" kindref="member">default_vehicle</ref>),new_sblock<sp/>+<sp/><ref refid="uvfr__settings_8h_1abcf807ab03bef940a111bb64cfffecfa" kindref="member">GENERAL_VEH_INFO_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref>));</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//OS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="group__state__engine_1gad9e02be6d2d0bc1ab5cd9fd8cae34230" kindref="member">default_os_settings</ref>),(new_sblock<sp/>+<sp/><ref refid="uvfr__settings_8h_1a012d0d54f18a0eeee83d89f5786db5d5" kindref="member">OS_SETTINGS_OFFSET</ref><sp/>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref>));</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Motor<sp/>controller</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="uvfr__settings_8c_1a1c7fecf890841f27a4ca39fc66e8cc1b" kindref="member">mc_default_settings</ref>),(new_sblock+256*<ref refid="uvfr__settings_8h_1aad0db57c7f8c7937be54192d7b74bdcf" kindref="member">MOTOR_MGROUP</ref>+<ref refid="uvfr__settings_8h_1aa990a9c990001dc29a5ee5fdde3773e4" kindref="member">MOTOR_OFFSET</ref>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref>));</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"></highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Driving<sp/>Loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="uvfr__settings_8c_1a44daa1a9c68be860616e7bc627d9b8f4" kindref="member">default_dl_settings</ref>),(new_sblock+256*<ref refid="uvfr__settings_8h_1aaad501c2b79f55f1bbbae030b6a18dcd" kindref="member">DRIVING_MGROUP</ref>+<ref refid="uvfr__settings_8h_1a16f051ea34ee4f4965e4d11f3745d742" kindref="member">DRIVING_OFFSET</ref>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdriving__loop__args" kindref="compound">driving_loop_args</ref>));</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"></highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//BMS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="uvfr__settings_8c_1a28e4314b233b9140e73e4fd0bab7e354" kindref="member">default_bms_settings</ref>),(new_sblock+256*<ref refid="uvfr__settings_8h_1a25a35d43902b9bec03daae2ef17883b1" kindref="member">BMS_MGROUP</ref>+<ref refid="uvfr__settings_8h_1a95973d7f17e9a5994743b16520f6a136" kindref="member">BMS_OFFSET</ref>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structbms__settings__t" kindref="compound">bms_settings_t</ref>));</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"></highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//IMD</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="uvfr__settings_8c_1a1071bc1cceac3198de98d9c0753044d6" kindref="member">default_imd_settings</ref>),(new_sblock+256*<ref refid="uvfr__settings_8h_1ae5fe9f0cb3fad913bd688758c9b24d79" kindref="member">IMD_MGROUP</ref>+<ref refid="uvfr__settings_8h_1a790b81866b0c7880d2d8fcb39880885a" kindref="member">IMD_OFFSET</ref>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref>));</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//PDU</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(&amp;<ref refid="uvfr__settings_8c_1a07c6d6c6f641c6fb60600b9bd7efbf7e" kindref="member">default_pdu_settings</ref>),new_sblock<sp/>+<sp/>256*<ref refid="uvfr__settings_8h_1aa77056695d9689ca6642d5b7176e33c9" kindref="member">PDU_MGROUP</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1a8336472ba83c36033d7d4511a2e3b53e" kindref="member">PDU_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv19__pdu__settings" kindref="compound">uv19_pdu_settings</ref>));</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"></highlight></codeline>
<codeline lineno="1092"><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//DAQ<sp/>Head<sp/>+<sp/>Meta<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)&amp;<ref refid="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" kindref="member">default_daq_settings</ref>,(new_sblock+256*<ref refid="uvfr__settings_8h_1a14f988f2e948d8f522f0ef04a29762d6" kindref="member">DAQ_HEAD_MGROUP</ref>+<ref refid="uvfr__settings_8h_1afc36afa04b73fc9a1ea92b22e6cb564f" kindref="member">DAQ_HEAD_OFFSET</ref>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref>));</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Settings<sp/>Being<sp/>Logged</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a854e0900506f03ff53ff3ed1a9dc97ca" kindref="member">settingCopy</ref>((uint8_t*)(<ref refid="uvfr__settings_8c_1af5ab2cd7ec858145d49d4e585e4bef94" kindref="member">default_datapoints</ref>),(new_sblock<sp/>+<sp/>256*<ref refid="uvfr__settings_8h_1a084bd6444fb9817cc88531b879ba571b" kindref="member">DAQ_PARAMS1_MGROUP</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1a10d6e75bc6bdeb4dec495cbfe05682fd" kindref="member">DAQ_PARAMS1_OFFSET</ref>),</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref>)*<ref refid="uvfr__settings_8c_1ad795c6981571499e4a90ef72698b6ea1" kindref="member">default_daq_settings</ref>.<ref refid="structdaq__loop__args_1acb7bf20ade7a6544c747aebc165b7faf" kindref="member">total_params_logged</ref>);</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>settingCopy(0,0,0);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1099"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>settingCopy(0,0,0);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1100"><highlight class="normal"></highlight></codeline>
<codeline lineno="1101"><highlight class="normal"></highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>ecode<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" kindref="member">uvSaveSettingsToFlash</ref>(new_sblock,<sp/>&amp;ecode)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Try<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//uvSendCanMSG(&amp;vcu_ack_msg);<sp/>//report<sp/>success</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a71b4d19fc9194c90d6b546a1b8138902" kindref="member">uvSaveSettingsToFlash</ref>(new_sblock,<sp/>&amp;ecode)<sp/>==<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Try<sp/>again</highlight></codeline>
<codeline lineno="1110"><highlight class="comment"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Once<sp/>we<sp/>reach<sp/>this<sp/>point<sp/>we<sp/>know<sp/>that<sp/>some<sp/>error<sp/>has<sp/>in<sp/>fact<sp/>occurred.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a0acc0e528de17ca0616ca14d82e92ba5" kindref="member">INVALID_SBLOCK</ref>){</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a7922bc9d90bb507f9885103792e4343f" kindref="member">FLASH_NOT_UNLOCKED</ref>){</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"></highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a0202712190ca1bce6a198dd196f48c4b" kindref="member">DID_NOT_FINISH_PROGRAMMING</ref>){</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1ae9b3336d2f9087deea03d9adac5d06fd" kindref="member">DATA_MISMATCH</ref>){</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"></highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a4fc65d72946e3e169f15ed0015fa3d3c" kindref="member">PRE_CHECKSUM</ref>){</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"></highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>==<sp/><ref refid="uvfr__settings_8c_1a1e63b2fed237e9d016b304884c01457b" kindref="member">POST_CHECKSUM</ref>){</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"></highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(ecode<sp/>!=<sp/>0){</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>section<sp/>of<sp/>code<sp/>is<sp/>one<sp/>of<sp/>the<sp/>worst<sp/>places<sp/>to<sp/>be<sp/>in<sp/>the<sp/>vehicle.</highlight></codeline>
<codeline lineno="1128"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="1129"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"></highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>we<sp/>reach<sp/>this<sp/>point,<sp/>then<sp/>both<sp/>attempts<sp/>at<sp/>uvSaveSettingsToFlash<sp/>have<sp/>failed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//This<sp/>is<sp/>not<sp/>a<sp/>good<sp/>situation<sp/>to<sp/>be<sp/>in,<sp/>since<sp/>data<sp/>corruption<sp/>may<sp/>have<sp/>occurred.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"></highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"></highlight></codeline>
<codeline lineno="1138"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"></highlight></codeline>
<codeline lineno="1143" refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" refkind="member"><highlight class="normal"><ref refid="can_8h_1aef3770e45bbacbf527fd93dd80eea9b9" kindref="member">uv_status</ref><sp/><ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(uint8_t*<sp/>origin,uint8_t<sp/>memgroup,uint8_t<sp/>m_offset,<sp/>uint16_t<sp/>size){</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/>uint16_t<sp/>newsize<sp/>=<sp/>size<sp/>+<sp/>size%4;</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"></highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//We<sp/>always<sp/>send<sp/>the<sp/>32<sp/>bit<sp/>word,<sp/>because<sp/>the<sp/>VCU<sp/>does<sp/>not<sp/>track<sp/>what<sp/>the<sp/>individual<sp/>types<sp/>of<sp/>struct<sp/>members<sp/>are.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Doing<sp/>so<sp/>would<sp/>be<sp/>stupid<sp/>complicated,<sp/>so<sp/>not<sp/>gonna<sp/>bother.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i&lt;newsize;<sp/>i+=4){</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Send<sp/>the<sp/>actual<sp/>msg</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1abdad8cd245f0f77d58548f011775a572" kindref="member">uvSendSpecificParam</ref>(origin,memgroup,m_offset<sp/>+<sp/>i,4)!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea480ef4e56d17703f0629bfe1e06bc4f0" kindref="member">UV_ERROR</ref>;</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Find<sp/>a<sp/>way<sp/>to<sp/>await<sp/>an<sp/>ack<sp/>message</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"></highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="1158"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"></highlight></codeline>
<codeline lineno="1163" refid="uvfr__settings_8c_1a4610dbfba4a1c427386d906bfc656b77" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a4610dbfba4a1c427386d906bfc656b77" kindref="member">sendAllSettingsWorker</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args){</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structsetting__helper__task" kindref="compound">setting_helper_task</ref>*<sp/>params<sp/>=<sp/>(<ref refid="structsetting__helper__task" kindref="compound">setting_helper_task</ref>*)<sp/>args;</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1a19de39f55cc05851f5fa6a40070681e3" kindref="member">child_task_handle</ref><sp/>=<sp/>params-&gt;<ref refid="structsetting__helper__task_1a867ac831a9ae5bbfb2ee7b32d63e8916" kindref="member">meta_task_handle</ref>;</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"></highlight></codeline>
<codeline lineno="1167"><highlight class="normal"></highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t*<sp/>origin<sp/>=<sp/>params-&gt;<ref refid="structsetting__helper__task_1a2db368e63a9cc11c26caa2a0eacfca45" kindref="member">args</ref>.<ref refid="unionhelper__task__args_1a083dff2889a9c9006875745783ed5f45" kindref="member">setting_tx_args</ref>.<ref refid="structtx__all__settings__args_1a8e42222b51c2f152869fc760560442b0" kindref="member">sblock_origin</ref>;</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!origin){</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>origin<sp/>=<sp/><ref refid="uvfr__settings_8h_1a1af6d32a5f9f7c214731b3cdde2ae48d" kindref="member">FLASH_SBLOCK_START</ref>;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/>params-&gt;<ref refid="structsetting__helper__task_1a7446a818ec9497a6b93a7995bf8b66d3" kindref="member">status</ref><sp/>=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>;</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"></highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1af0cbf7f4ea57695f3b1d2d3c83844000" kindref="member">child_task_active</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"></highlight></codeline>
<codeline lineno="1177"><highlight class="normal"></highlight></codeline>
<codeline lineno="1178"><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Get<sp/>through<sp/>all<sp/>this<sp/>stuff<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1aa896deeb35bafb45b994e9c1d0c6500a" kindref="member">GENERAL_VEH_INFO_MGROUP</ref>,<sp/><ref refid="uvfr__settings_8h_1abcf807ab03bef940a111bb64cfffecfa" kindref="member">GENERAL_VEH_INFO_OFFSET</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structveh__gen__info" kindref="compound">veh_gen_info</ref>))!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1ae727eadb1cf71a3feeb12b7bb2eb83d5" kindref="member">OS_SETTINGS_MGROUP</ref>,<sp/><ref refid="uvfr__settings_8h_1a012d0d54f18a0eeee83d89f5786db5d5" kindref="member">OS_SETTINGS_OFFSET</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__os__settings" kindref="compound">uv_os_settings</ref>))!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1aad0db57c7f8c7937be54192d7b74bdcf" kindref="member">MOTOR_MGROUP</ref>,<ref refid="uvfr__settings_8h_1aa990a9c990001dc29a5ee5fdde3773e4" kindref="member">MOTOR_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structmotor__controller__settings" kindref="compound">motor_controller_settings</ref>))!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1aaad501c2b79f55f1bbbae030b6a18dcd" kindref="member">DRIVING_MGROUP</ref>,<ref refid="uvfr__settings_8h_1a16f051ea34ee4f4965e4d11f3745d742" kindref="member">DRIVING_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdriving__loop__args" kindref="compound">driving_loop_args</ref>))!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1ae5fe9f0cb3fad913bd688758c9b24d79" kindref="member">IMD_MGROUP</ref>,<ref refid="uvfr__settings_8h_1a790b81866b0c7880d2d8fcb39880885a" kindref="member">IMD_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv__imd__settings" kindref="compound">uv_imd_settings</ref>))!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1a25a35d43902b9bec03daae2ef17883b1" kindref="member">BMS_MGROUP</ref>,<ref refid="uvfr__settings_8h_1a95973d7f17e9a5994743b16520f6a136" kindref="member">BMS_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structbms__settings__t" kindref="compound">bms_settings_t</ref>))!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1a14f988f2e948d8f522f0ef04a29762d6" kindref="member">DAQ_HEAD_MGROUP</ref>,<ref refid="uvfr__settings_8h_1afc36afa04b73fc9a1ea92b22e6cb564f" kindref="member">DAQ_HEAD_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref>))!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,<ref refid="uvfr__settings_8h_1aa77056695d9689ca6642d5b7176e33c9" kindref="member">PDU_MGROUP</ref>,<ref refid="uvfr__settings_8h_1a8336472ba83c36033d7d4511a2e3b53e" kindref="member">PDU_OFFSET</ref>,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structuv19__pdu__settings" kindref="compound">uv19_pdu_settings</ref>))<sp/>!=<sp/><ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"></highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Next<sp/>is<sp/>whatever<sp/>in<sp/>god&apos;s<sp/>green<sp/>earth<sp/>the<sp/>DAQ_datapoints<sp/>are<sp/>up<sp/>to<sp/>(Me<sp/>when<sp/>the<sp/>edge<sp/>case<sp/>hits<sp/>just<sp/>right)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/>uint16_t<sp/>remaining_bytes<sp/>=<sp/>(((<ref refid="structdaq__loop__args" kindref="compound">daq_loop_args</ref>*)(origin<sp/>+<sp/>256*<ref refid="uvfr__settings_8h_1a14f988f2e948d8f522f0ef04a29762d6" kindref="member">DAQ_HEAD_MGROUP</ref><sp/>+<sp/><ref refid="uvfr__settings_8h_1afc36afa04b73fc9a1ea92b22e6cb564f" kindref="member">DAQ_HEAD_OFFSET</ref>))-&gt;total_params_logged)*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="daq_8h_1ad3bc3bc1c9ab04b22cc999a6f7c82c40" kindref="member">daq_datapoint</ref>);</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"></highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>t_mgroup<sp/>=<sp/><ref refid="uvfr__settings_8h_1a084bd6444fb9817cc88531b879ba571b" kindref="member">DAQ_PARAMS1_MGROUP</ref>;</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"></highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal">(remaining_bytes<sp/>&gt;<sp/>256){</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,t_mgroup,<ref refid="uvfr__settings_8h_1a10d6e75bc6bdeb4dec495cbfe05682fd" kindref="member">DAQ_PARAMS1_OFFSET</ref>,256)!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"></highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remaining_bytes<sp/>-=<sp/>256;</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t_mgroup++;</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"></highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="uvfr__settings_8c_1a7572b56a19346ee479bd66789c616bfb" kindref="member">uvSendSettingGroup</ref>(origin,t_mgroup,<ref refid="uvfr__settings_8h_1a10d6e75bc6bdeb4dec495cbfe05682fd" kindref="member">DAQ_PARAMS1_OFFSET</ref>,remaining_bytes)!=<ref refid="uvfr__utils_8h_1a71c52c44be11d0980910401cb9b5fb9ea93b7493f003cb72e7b6138f2794b58e9" kindref="member">UV_OK</ref>){</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Handle<sp/>this<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"></highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="uvfr__settings_8c_1af0cbf7f4ea57695f3b1d2d3c83844000" kindref="member">child_task_active</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"></highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/>vTaskSuspend(NULL);</highlight></codeline>
<codeline lineno="1220"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"></highlight></codeline>
<codeline lineno="1226" refid="uvfr__settings_8c_1a632dfb21b35fd170c003515ef4bdc291" refkind="member"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="uvfr__settings_8c_1a632dfb21b35fd170c003515ef4bdc291" kindref="member">sendJournalWorker</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">*<sp/>args){</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="Core/Src/uvfr_settings.c"/>
  </compounddef>
</doxygen>
